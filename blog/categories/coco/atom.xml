<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">

  <title><![CDATA[Catégorie : coco | Xavier Nayrac]]></title>
  <link href="http://lkdjiin.github.io/blog/categories/coco/atom.xml" rel="self"/>
  <link href="http://lkdjiin.github.io/"/>
  <updated>2015-07-08T14:54:59+02:00</updated>
  <id>http://lkdjiin.github.io/</id>
  <author>
    <name><![CDATA[Xavier Nayrac]]></name>
    
  </author>
  <generator uri="http://octopress.org/">Octopress</generator>

  
  <entry>
    <title type="html"><![CDATA[Sortie de Coco version 0.11.0]]></title>
    <link href="http://lkdjiin.github.io/blog/2014/05/24/sortie-de-coco-version-0-dot-11-dot-0/"/>
    <updated>2014-05-24T20:59:00+02:00</updated>
    <id>http://lkdjiin.github.io/blog/2014/05/24/sortie-de-coco-version-0-dot-11-dot-0</id>
    <content type="html"><![CDATA[<p>Je viens juste de mettre en ligne la version 0.11.0 de Coco, une gem de
<em>code coverage</em> pour Ruby.</p>

<!-- more -->

<p>Ce que fait cette nouvelle version:</p>

<ul>
  <li>Échappe proprement les entités HTML dans les rapports.</li>
  <li>Implémente des compteurs de <em>hit</em>.</li>
  <li>Sortie d’avertissement sur la console lors de l’utilisation de
fonctionnalités dépréciées.</li>
</ul>

<script id="fb33k8u">(function(i){var f,s=document.getElementById(i);f=document.createElement('iframe');f.src='//api.flattr.com/button/view/?uid=lkdjiin&url='+encodeURIComponent(document.URL);f.title='Flattr';f.height=62;f.width=55;f.style.borderWidth=0;s.parentNode.insertBefore(f,s);})('fb33k8u');</script>

<p>À demain.</p>

<p></p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Rails 4.1 avec Spring, Rspec ou Minitest et Coco]]></title>
    <link href="http://lkdjiin.github.io/blog/2014/04/21/rails-4-dot-1-avec-spring-rspec-ou-minitest-et-coco/"/>
    <updated>2014-04-21T21:15:00+02:00</updated>
    <id>http://lkdjiin.github.io/blog/2014/04/21/rails-4-dot-1-avec-spring-rspec-ou-minitest-et-coco</id>
    <content type="html"><![CDATA[<p><div class='level-tag level-tag-1'>Niveau : <span>facile</span></div></p>

<p>Rails 4.1 est sorti récemment. Une des nouveautés est qu’il est livré avec
<a href="https://github.com/rails/spring">Spring</a>, qui permet d’accélerer le
développement en gardant, en quelque sorte, l’application rails en mémoire.
Voici, très rapidement, comment configurer Rails 4.1 avec soit Rspec, soit
Minitest comme framework de test, et <a href="https://github.com/lkdjiin/coco">Coco</a> comme outil de <em>code coverage</em>.</p>

<!-- more -->

<p>Tout d’abord, l’installation de la dernière version de rails:</p>

<pre><code>gem install rails
</code></pre>

<p>Puis la création d’une application de test:</p>

<pre><code>rails new testappli -T
</code></pre>

<p>Ensuite, si vous utiliser <strong>Rspec</strong>, le Gemfile:</p>

<p>``` ruby Gemfile
group :development, :test do
  gem ‘spring-commands-rspec’
  gem ‘rspec-rails’
end</p>

<p>group :test do
  gem ‘coco’
end
```</p>

<p>L’installation des gems:</p>

<pre><code>bundle install
</code></pre>

<p>L’installation de rspec:</p>

<pre><code>rails g rspec:install
</code></pre>

<p>La création de <code>bin/rspec</code>:</p>

<pre><code>spring binstub --all
</code></pre>

<p>La mise en place de Coco dans le fichier <code>spec/spec_helper.rb</code>:</p>

<p><code>ruby spec/spec_helper.rb
# Toute dernière ligne (ou bien toute première, au choix)
require 'coco'
</code></p>

<p>Finalement vous pouvez lancer les tests ainsi:</p>

<pre><code>bin/rspec
</code></pre>

<p>Si, au contraire, vous avez choisi <strong>Minitest</strong>, vous ajouterez ceci dans votre Gemfile:</p>

<p>``` ruby Gemfile
group :development, :test do
  gem ‘minitest-rails’, ‘2.0.0.beta1’
end</p>

<p>group :test do
  gem ‘coco’
end
```</p>

<p>Ensuite, l’installation:</p>

<pre><code>bundle install
rails g minitest:install 
</code></pre>

<p>La mise en place de Coco dans le fichier <code>test/test_helper.rb</code>:</p>

<p><code>ruby spec/spec_helper.rb
# Toute dernière ligne (ou bien toute première, au choix)
require 'coco'
</code></p>

<p>Finalement vous pouvez lancer les tests ainsi:</p>

<pre><code>bin/rake
</code></pre>

<p>Ou bien:</p>

<pre><code>bin/rake test
</code></pre>

<script id="fb33k8u">(function(i){var f,s=document.getElementById(i);f=document.createElement('iframe');f.src='//api.flattr.com/button/view/?uid=lkdjiin&url='+encodeURIComponent(document.URL);f.title='Flattr';f.height=62;f.width=55;f.style.borderWidth=0;s.parentNode.insertBefore(f,s);})('fb33k8u');</script>

<p>À demain.</p>

<p></p>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Couverture de code pour Ruby avec coco]]></title>
    <link href="http://lkdjiin.github.io/blog/2013/10/26/couverture-de-code-pour-ruby-avec-coco/"/>
    <updated>2013-10-26T18:07:00+02:00</updated>
    <id>http://lkdjiin.github.io/blog/2013/10/26/couverture-de-code-pour-ruby-avec-coco</id>
    <content type="html"><![CDATA[<p>Il y a 3 ans, j’ai écrit une gem Ruby pour faire de la couverture de
code (<em>code coverage</em>). <a href="https://github.com/colszowka/simplecov">SimpleCov</a>,
la gem la plus utilisée pour cette tâche venait tout juste de voir le
jour et ne me convenait pas entièrement. À l’époque je trouvais SimpleCov
trop ennuyeuse à configurer et à faire fonctionner.</p>

<!-- more -->

<p>Qu’on ne me fasse pas dire ce que je n’ai pas écrit : SimpleCov remplie
<em>parfaitement</em> sa tâche. C’est juste que je voulais un truc plus simple.
Je voulais quelque chose qui fonctionne en une ligne, avec configuration
optionnelle et surtout, avec un rapport de couverture
super simple et dépouillé. C’est comme ça qu’est née la gem
<a href="https://github.com/lkdjiin/coco">coco</a>. Bon ok, il m’est arrivé de me
demander si je ne l’avais pas écrit juste pour le jeu de mot…</p>

<p>Pour utiliser coco, il suffit de charger la gem au tout début des tests
comme ceci:</p>

<p><code>ruby
require 'coco'
</code></p>

<p>Et… c’est tout ! Chaque fois que vous lancerez les tests, coco produira un
rapport si (et seulement si) au moins un fichier n’est pas couvert à 100%.</p>

<p>La configuration, au besoin, se fait dans un fichier caché au format yaml,
à la racine du projet. Par exemple si vous trouvez qu’un taux de couverture
de 90% est acceptable, vous pouvez le changer comme ça:</p>

<pre><code>:threshold: 90
</code></pre>

<p>Si vous voulez exclure un fichier et un dossier complet du rapport vous
pouvez écrire:</p>

<pre><code>:excludes:
- lib/project/file1.rb
- config/initializers
</code></pre>

<p>Il y a plusieurs autres exemples de configuration sur le
<a href="https://github.com/lkdjiin/coco/wiki">wiki du projet</a>. Enfin, pour une
présentation rapide de coco, en anglais, il y a le
<a href="http://lkdjiin.github.io/coco/">site web</a>.</p>

<script id="fb33k8u">(function(i){var f,s=document.getElementById(i);f=document.createElement('iframe');f.src='//api.flattr.com/button/view/?uid=lkdjiin&url='+encodeURIComponent(document.URL);f.title='Flattr';f.height=62;f.width=55;f.style.borderWidth=0;s.parentNode.insertBefore(f,s);})('fb33k8u');</script>

<p>À demain.</p>

<p></p>

]]></content>
  </entry>
  
</feed>
