<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">

  <title><![CDATA[Catégorie : introspection | Xavier Nayrac]]></title>
  <link href="http://lkdjiin.github.io/blog/categories/introspection/atom.xml" rel="self"/>
  <link href="http://lkdjiin.github.io/"/>
  <updated>2015-04-30T17:16:55+02:00</updated>
  <id>http://lkdjiin.github.io/</id>
  <author>
    <name><![CDATA[Xavier Nayrac]]></name>
    
  </author>
  <generator uri="http://octopress.org/">Octopress</generator>

  
  <entry>
    <title type="html"><![CDATA[Introduction à l'introspection en Ruby]]></title>
    <link href="http://lkdjiin.github.io/blog/2014/04/08/introduction-a-lintrospection-en-ruby/"/>
    <updated>2014-04-08T21:23:00+02:00</updated>
    <id>http://lkdjiin.github.io/blog/2014/04/08/introduction-a-lintrospection-en-ruby</id>
    <content type="html"><![CDATA[<p><div class='level-tag level-tag-1'>Niveau : <span>facile</span></div></p>

<p>L’introspection consiste à obtenir des informations sur un objet au
moment de l’exécution d’un programme. Voyons à quoi ça ressemble.</p>

<!-- more -->

<p>Créons une classe <code>Inspector</code> qui va extraire certaines informations
des objets qu’on lui donnera:</p>

<p>``` ruby introspection.rb
class Inspector
  class « self
    def classname(o)
      o.class.name
    end</p>

<pre><code>def methods(c)
  c.instance_methods(false)
end

def parameters(o, m)
  o.method(m).parameters
end   end end ```
</code></pre>

<p>Dans cet exemple nous allons récupérer le nom de la classe, le nom des
méthodes et certaines informations sur les arguments des méthodes.</p>

<p>Voyons comment ça marche en récupérant le nom de la classe <code>Object</code>:</p>

<p><code>irb
&gt;&gt; load './introspection.rb'
&gt;&gt; p Inspector.classname(Object.new)
"Object"
</code></p>

<p>Maintenant ajoutons une classe <code>C</code> avec quelques méthodes:</p>

<p>``` ruby introspection.rb
class Inspector
  class « self
    def classname(o)
      o.class.name
    end</p>

<pre><code>def methods(c)
  c.instance_methods(false)
end

def parameters(o, m)
  o.method(m).parameters
end   end end
</code></pre>

<p>class C
  def foo
  end</p>

<p>def bar(arg1, arg2)
  end</p>

<p>def baz(arg1, *args, &amp;block)
  end
end
```</p>

<p>Les méthodes de la classe <code>C</code> ne font rien. C’est normal, ce qui nous
intéresse ici c’est leur signature. D’abord le nom de la classe:</p>

<p><code>irb
&gt;&gt; load './introspection.rb'
&gt;&gt; p Inspector.classname(C.new)
"C"
</code></p>

<p>Facile. Maintenant récupérons les méthodes:</p>

<p><code>irb
&gt;&gt; p Inspector.methods(C)
[:foo, :bar, :baz]
</code></p>

<p>Pas mal. Encore plus fort, inspectons les arguments de chacune des
méthodes:</p>

<p><code>irb
&gt;&gt; Inspector.methods(C).each do |m|
?&gt;   p Inspector.parameters(C.new, m)
&gt;&gt; end
[]
[[:req, :arg1], [:req, :arg2]]
[[:req, :arg1], [:rest, :args], [:block, :block]]
</code></p>

<p>Voilà, c’était une rapide mise en bouche du <em>comment faire ?</em>.
Pour le <em>à quoi ça sert ?</em>, il faudra attendre un prochain article ;)</p>

<script id="fb33k8u">(function(i){var f,s=document.getElementById(i);f=document.createElement('iframe');f.src='//api.flattr.com/button/view/?uid=lkdjiin&url='+encodeURIComponent(document.URL);f.title='Flattr';f.height=62;f.width=55;f.style.borderWidth=0;s.parentNode.insertBefore(f,s);})('fb33k8u');</script>

<p>À demain.</p>

<p></p>
]]></content>
  </entry>
  
</feed>
