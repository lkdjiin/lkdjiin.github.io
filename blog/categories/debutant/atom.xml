<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">

  <title><![CDATA[Catégorie : débutant | lkdjiin's blog]]></title>
  <link href="http://lkdjiin.github.io/blog/categories/debutant/atom.xml" rel="self"/>
  <link href="http://lkdjiin.github.io/"/>
  <updated>2014-04-26T14:46:41+02:00</updated>
  <id>http://lkdjiin.github.io/</id>
  <author>
    <name><![CDATA[Xavier Nayrac]]></name>
    
  </author>
  <generator uri="http://octopress.org/">Octopress</generator>

  
  <entry>
    <title type="html"><![CDATA[Le double bang en Ruby]]></title>
    <link href="http://lkdjiin.github.io/blog/2014/04/23/le-double-bang-en-ruby/"/>
    <updated>2014-04-23T20:59:00+02:00</updated>
    <id>http://lkdjiin.github.io/blog/2014/04/23/le-double-bang-en-ruby</id>
    <content type="html"><![CDATA[<p><div class='level-tag level-tag-1'>Niveau : <span>facile</span></div></p>

<h2>Ou encore !!, ou double point d'exclamation</h2>

<p>On peut voir ici ou là ce genre de code Ruby:</p>

<pre><code>!!expression
</code></pre>

<p><em>-C'est un truc qui n'est d'ailleurs pas spécifique au langage Ruby-</em>
Pourquoi voudrait-on écrire ça ?</p>

<!-- more -->


<p>Le <code>!</code> (not) fait une négation booléenne. Donc si une expression est <code>true</code>,
cela va donner <code>false</code>, et inversement, si une expression est <code>false</code>, cela
va donner <code>true</code>. Exemple:</p>

<p>``` irb
$ irb</p>

<blockquote><blockquote><p>!true
=> false
!false
=> true
```</p></blockquote></blockquote>

<p>Donc le <code>!!</code> est la négation booléenne d'une négation booléenne! Hum, ça
a l'air un peu inutile, hein:</p>

<p>``` irb</p>

<blockquote><blockquote><p>!!true
=> true
!!false
=> false
```</p></blockquote></blockquote>

<p>Ce qu'il ne faut pas oublier, c'est qu'en Ruby, comme dans plein d'autres
langages, beaucoup de choses peuvent être <strong>true</strong> ou <strong>false</strong>.
La preuve pour <code>true</code>:</p>

<p>``` irb</p>

<blockquote><blockquote><p>puts &lsquo;ok&rsquo; if &lsquo;kind of true value&rsquo;
ok
puts &lsquo;ok&rsquo; if [1, 2]
ok
puts &lsquo;ok&rsquo; if []
ok
```</p></blockquote></blockquote>

<p>En fait, toute valeur autre que <code>false</code> ou <code>nil</code> est considérée comme <code>true</code>.
Et le corollaire: sont considérées comme <code>false</code> les valeurs <code>false</code> ou <code>nil</code>.</p>

<p>On peut maintenant voir l'intérêt du <code>!!</code>. Soit la classe suivante pour nous
servir d'exemple:</p>

<p>``` ruby
class Connection
  def initialize(connection = nil)</p>

<pre><code>@connection = connection
</code></pre>

<p>  end</p>

<p>  # Returns a boolean.
  def connected?</p>

<pre><code>!!@connection
</code></pre>

<p>  end
end
```</p>

<p>Bien que <code>@connection</code> soit <code>nil</code> ou un objet quelconque, je veux que
<code>connected?</code> renvoit <code>true</code> ou <code>false</code>. Pour ça je peux écrire:</p>

<pre><code>if @connection
  true
else
  false
end
</code></pre>

<p>ou bien encore:</p>

<pre><code>@connection ? true : false
</code></pre>

<p>Mais le <code>!!@connection</code> fonctionne tout aussi bien. Il est plus concis, et
surtout exprime bien le <em>cast</em> en booléen:</p>

<p>``` irb</p>

<blockquote><blockquote><p>c1 = Connection.new
=> #&lt;Connection:0x9236910 @connection=nil>
c1.connected?
=> false
c2 = Connection.new(Object.new)
=> #&lt;Connection:0x922deb4 @connection=#&lt;Object:0x922dec8>>
c2.connected?
=> true
```</p></blockquote></blockquote>

<script id='fb33k8u'>(function(i){var f,s=document.getElementById(i);f=document.createElement('iframe');f.src='//api.flattr.com/button/view/?uid=lkdjiin&url='+encodeURIComponent(document.URL);f.title='Flattr';f.height=62;f.width=55;f.style.borderWidth=0;s.parentNode.insertBefore(f,s);})('fb33k8u');</script>


<p>À demain.</p>

<p></p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Demandez conseil régulièrement]]></title>
    <link href="http://lkdjiin.github.io/blog/2014/04/22/demandez-conseil-regulierement/"/>
    <updated>2014-04-22T21:43:00+02:00</updated>
    <id>http://lkdjiin.github.io/blog/2014/04/22/demandez-conseil-regulierement</id>
    <content type="html"><![CDATA[<p><div class='level-tag level-tag-1'>Niveau : <span>facile</span></div></p>

<p>Aujourd'hui je réparais un bug, rien de très compliqué, juste un
évènement qui n'était pas appelé. Et j'en ai profité pour faire un
refactoring: passer d'une grosse méthode de classe à quelque chose de
plus construit.</p>

<!-- more -->


<p>En gros on avait cette structure:</p>

<p>``` ruby
module Machin
  class Truc</p>

<pre><code>def self.foo(des, arguments)
  # Plusieurs
  # lignes
  # d'initialisation
  # de variables.
  # Plusieurs
  # lignes
  # de calculs
  # divers.
  # Et j'en passe
  # ...
end
</code></pre>

<p>  end
end
```</p>

<p>J'ai fait un refactoring dans ce genre:</p>

<p>```
module Machin
  class Truc</p>

<pre><code>def self.foo
  implementation = TrucImplementation.new(des, arguments)
  implementation.fait_ce_que_tu_as_a_faire
end

class TrucImplementation
  def initialize(des, arguments)
    # Initialisation.
  end

  def fait_ce_que_tu_as_a_faire
    # Ceci.
    # Cela.
  end

  private

  def ceci
    # ...
  end

  def cela
    # ...
  end
end
</code></pre>

<p>  end
end
```</p>

<p>Mais j'étais vraiment ennuyé avec ce nom <code>TrucImplementation</code>. Je trouvais
que ça ne faisait pas très Ruby. Bref j'avais un sentiment bizarre sur ce
code donc j'ai demandé aux collègues une revue de code en disant que
j'aimerais bien nommé ça autrement…</p>

<p>La réponse n'a pas tardée, simple et sybilline: «Tu passes juste les méthodes de
<code>TrucImplementation</code> dans <code>Truc</code> et plus de soucis».</p>

<p>Pourquoi je raconte ça ? Pour me rappeler que parfois, avoir le nez dans le
code trop longtemps fait que tu ne vois plus ce qui est évident. Il ne faut
pas hésiter à demander un coup de main ; un point de vue différent, ou juste
plus frais, peut vite faire une différence.</p>

<p>Je pense que je n'ai pas fini d'être chambré là-dessus ;)</p>

<script id='fb33k8u'>(function(i){var f,s=document.getElementById(i);f=document.createElement('iframe');f.src='//api.flattr.com/button/view/?uid=lkdjiin&url='+encodeURIComponent(document.URL);f.title='Flattr';f.height=62;f.width=55;f.style.borderWidth=0;s.parentNode.insertBefore(f,s);})('fb33k8u');</script>


<p>À demain.</p>

<p></p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Rails 4.1 avec Spring, Rspec ou Minitest et Coco]]></title>
    <link href="http://lkdjiin.github.io/blog/2014/04/21/rails-4-dot-1-avec-spring-rspec-ou-minitest-et-coco/"/>
    <updated>2014-04-21T21:15:00+02:00</updated>
    <id>http://lkdjiin.github.io/blog/2014/04/21/rails-4-dot-1-avec-spring-rspec-ou-minitest-et-coco</id>
    <content type="html"><![CDATA[<p><div class='level-tag level-tag-1'>Niveau : <span>facile</span></div></p>

<p>Rails 4.1 est sorti récemment. Une des nouveautés est qu'il est livré avec
<a href="https://github.com/rails/spring">Spring</a>, qui permet d'accélerer le
développement en gardant, en quelque sorte, l'application rails en mémoire.
Voici, très rapidement, comment configurer Rails 4.1 avec soit Rspec, soit
Minitest comme framework de test, et <a href="https://github.com/lkdjiin/coco">Coco</a> comme outil de <em>code coverage</em>.</p>

<!-- more -->


<p>Tout d'abord, l'installation de la dernière version de rails:</p>

<pre><code>gem install rails
</code></pre>

<p>Puis la création d'une application de test:</p>

<pre><code>rails new testappli -T
</code></pre>

<p>Ensuite, si vous utiliser <strong>Rspec</strong>, le Gemfile:</p>

<p>``` ruby Gemfile
group :development, :test do
  gem &lsquo;spring-commands-rspec&rsquo;
  gem &lsquo;rspec-rails&rsquo;
end</p>

<p>group :test do
  gem &lsquo;coco&rsquo;
end
```</p>

<p>L'installation des gems:</p>

<pre><code>bundle install
</code></pre>

<p>L'installation de rspec:</p>

<pre><code>rails g rspec:install
</code></pre>

<p>La création de <code>bin/rspec</code>:</p>

<pre><code>spring binstub --all
</code></pre>

<p>La mise en place de Coco dans le fichier <code>spec/spec_helper.rb</code>:</p>

<p>``` ruby spec/spec_helper.rb</p>

<h1>Toute dernière ligne (ou bien toute première, au choix)</h1>

<p>require &lsquo;coco&rsquo;
```</p>

<p>Finalement vous pouvez lancer les tests ainsi:</p>

<pre><code>bin/rspec
</code></pre>

<p>Si, au contraire, vous avez choisi <strong>Minitest</strong>, vous ajouterez ceci dans votre Gemfile:</p>

<p>``` ruby Gemfile
group :development, :test do
  gem &lsquo;minitest-rails&rsquo;, &lsquo;2.0.0.beta1&rsquo;
end</p>

<p>group :test do
  gem &lsquo;coco&rsquo;
end
```</p>

<p>Ensuite, l'installation:</p>

<pre><code>bundle install
rails g minitest:install 
</code></pre>

<p>La mise en place de Coco dans le fichier <code>test/test_helper.rb</code>:</p>

<p>``` ruby spec/spec_helper.rb</p>

<h1>Toute dernière ligne (ou bien toute première, au choix)</h1>

<p>require &lsquo;coco&rsquo;
```</p>

<p>Finalement vous pouvez lancer les tests ainsi:</p>

<pre><code>bin/rake
</code></pre>

<p>Ou bien:</p>

<pre><code>bin/rake test
</code></pre>

<script id='fb33k8u'>(function(i){var f,s=document.getElementById(i);f=document.createElement('iframe');f.src='//api.flattr.com/button/view/?uid=lkdjiin&url='+encodeURIComponent(document.URL);f.title='Flattr';f.height=62;f.width=55;f.style.borderWidth=0;s.parentNode.insertBefore(f,s);})('fb33k8u');</script>


<p>À demain.</p>

<p></p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Plugin vim-refactor pour Ruby]]></title>
    <link href="http://lkdjiin.github.io/blog/2014/04/15/plugin-vim-refactor-pour-ruby/"/>
    <updated>2014-04-15T21:23:00+02:00</updated>
    <id>http://lkdjiin.github.io/blog/2014/04/15/plugin-vim-refactor-pour-ruby</id>
    <content type="html"><![CDATA[<p><div class='level-tag level-tag-1'>Niveau : <span>facile</span></div></p>

<p>Voici un plugin Vim issu d'une expérience qu'on mène avec un collègue:
<a href="https://github.com/lkdjiin/vim-refactor">vim-refactor</a>.
Il fonctionne pour l'instant sur du code Ruby et permet d'extraire une
méthode.</p>

<!-- more -->


<p>À partir de ce genre de code:</p>

<p>``` ruby
class HelloWorld</p>

<p>  def greet</p>

<pre><code>greeting = "Hello World!"
puts greeting
</code></pre>

<p>  end</p>

<p>end
```</p>

<p>En étant positionné sur la ligne 4, et en appelant <code>:ExtractMethod</code>
(ou bien sûr un mapping quelconque) vous obtenez ceci:</p>

<p>``` ruby
class HelloWorld</p>

<p>  def greet</p>

<pre><code>puts greeting
</code></pre>

<p>  end</p>

<p>  def greeting</p>

<pre><code>"Hello World!"
</code></pre>

<p>  end
end
```</p>

<p>C'est vraiment une version <em>alpha</em>. On espère implémenter d'autres types
de refactoring et supporter d'autres langages.</p>

<script id='fb33k8u'>(function(i){var f,s=document.getElementById(i);f=document.createElement('iframe');f.src='//api.flattr.com/button/view/?uid=lkdjiin&url='+encodeURIComponent(document.URL);f.title='Flattr';f.height=62;f.width=55;f.style.borderWidth=0;s.parentNode.insertBefore(f,s);})('fb33k8u');</script>


<p>À demain.</p>

<p></p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Introduction à l'introspection en Ruby]]></title>
    <link href="http://lkdjiin.github.io/blog/2014/04/08/introduction-a-lintrospection-en-ruby/"/>
    <updated>2014-04-08T21:23:00+02:00</updated>
    <id>http://lkdjiin.github.io/blog/2014/04/08/introduction-a-lintrospection-en-ruby</id>
    <content type="html"><![CDATA[<p><div class='level-tag level-tag-1'>Niveau : <span>facile</span></div></p>

<p>L'introspection consiste à obtenir des informations sur un objet au
moment de l'exécution d'un programme. Voyons à quoi ça ressemble.</p>

<!-- more -->


<p>Créons une classe <code>Inspector</code> qui va extraire certaines informations
des objets qu'on lui donnera:</p>

<p>``` ruby introspection.rb
class Inspector
  class &lt;&lt; self</p>

<pre><code>def classname(o)
  o.class.name
end

def methods(c)
  c.instance_methods(false)
end

def parameters(o, m)
  o.method(m).parameters
end
</code></pre>

<p>  end
end
```</p>

<p>Dans cet exemple nous allons récupérer le nom de la classe, le nom des
méthodes et certaines informations sur les arguments des méthodes.</p>

<p>Voyons comment ça marche en récupérant le nom de la classe <code>Object</code>:</p>

<p>``` irb</p>

<blockquote><blockquote><p>load &lsquo;./introspection.rb&rsquo;
p Inspector.classname(Object.new)
&ldquo;Object&rdquo;
```</p></blockquote></blockquote>

<p>Maintenant ajoutons une classe <code>C</code> avec quelques méthodes:</p>

<p>``` ruby introspection.rb
class Inspector
  class &lt;&lt; self</p>

<pre><code>def classname(o)
  o.class.name
end

def methods(c)
  c.instance_methods(false)
end

def parameters(o, m)
  o.method(m).parameters
end
</code></pre>

<p>  end
end</p>

<p>class C
  def foo
  end</p>

<p>  def bar(arg1, arg2)
  end</p>

<p>  def baz(arg1, *args, &amp;block)
  end
end
```</p>

<p>Les méthodes de la classe <code>C</code> ne font rien. C'est normal, ce qui nous
intéresse ici c'est leur signature. D'abord le nom de la classe:</p>

<p>``` irb</p>

<blockquote><blockquote><p>load &lsquo;./introspection.rb&rsquo;
p Inspector.classname(C.new)
&ldquo;C&rdquo;
```</p></blockquote></blockquote>

<p>Facile. Maintenant récupérons les méthodes:</p>

<p>``` irb</p>

<blockquote><blockquote><p>p Inspector.methods&copy;
[:foo, :bar, :baz]
```</p></blockquote></blockquote>

<p>Pas mal. Encore plus fort, inspectons les arguments de chacune des
méthodes:</p>

<p>``` irb</p>

<blockquote><blockquote><p>Inspector.methods&copy;.each do |m|
?>   p Inspector.parameters(C.new, m)
end
[]
[[:req, :arg1], [:req, :arg2]]
[[:req, :arg1], [:rest, :args], [:block, :block]]
```</p></blockquote></blockquote>

<p>Voilà, c'était une rapide mise en bouche du <em>comment faire ?</em>.
Pour le <em>à quoi ça sert ?</em>, il faudra attendre un prochain article ;)</p>

<script id='fb33k8u'>(function(i){var f,s=document.getElementById(i);f=document.createElement('iframe');f.src='//api.flattr.com/button/view/?uid=lkdjiin&url='+encodeURIComponent(document.URL);f.title='Flattr';f.height=62;f.width=55;f.style.borderWidth=0;s.parentNode.insertBefore(f,s);})('fb33k8u');</script>


<p>À demain.</p>

<p></p>
]]></content>
  </entry>
  
</feed>
