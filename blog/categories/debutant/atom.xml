<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">

  <title><![CDATA[Catégorie : débutant | lkdjiin's blog]]></title>
  <link href="http://lkdjiin.github.io/blog/categories/debutant/atom.xml" rel="self"/>
  <link href="http://lkdjiin.github.io/"/>
  <updated>2014-05-16T21:09:48+02:00</updated>
  <id>http://lkdjiin.github.io/</id>
  <author>
    <name><![CDATA[Xavier Nayrac]]></name>
    
  </author>
  <generator uri="http://octopress.org/">Octopress</generator>

  
  <entry>
    <title type="html"><![CDATA[Des benchmarks en général et de Ruby en particulier]]></title>
    <link href="http://lkdjiin.github.io/blog/2014/05/08/des-benchmarks-en-general-et-de-ruby-en-particulier/"/>
    <updated>2014-05-08T18:24:00+02:00</updated>
    <id>http://lkdjiin.github.io/blog/2014/05/08/des-benchmarks-en-general-et-de-ruby-en-particulier</id>
    <content type="html"><![CDATA[<p><div class='level-tag level-tag-1'>Niveau : <span>facile</span></div></p>

<p>En ce moment je fais quelques recherches sur la <em>lenteur</em> de Ruby.
J'aimerais faire un article sur pourquoi Ruby est lent et pourquoi ça
n'est pas un problême la plupart du temps.</p>

<p>Pendant ces recherches je suis tombé sur cet article:
<a href="http://blog.clifreeder.com/blog/2013/04/21/ruby-is-too-slow-for-programming-competitions/">Ruby Is Too Slow for Programming Competitions</a>.
Dans cet article, l'auteur utilise ce <a href="https://gist.github.com/clifff/5401367">script</a> de benchmark pour comparer deux manières différentes pour savoir
si un nombre est un <a href="http://fr.wikipedia.org/wiki/Nombre_palindrome">palindrome</a>.
La première manière utilise une méthode mathématique et la seconde manière
transforme le nombre en chaîne de caractères.</p>

<!-- more -->


<p>Alors je n'ai pas regardé le code en détail, j'ai juste voulu faire tourner
le benchmark sur quelques version de Ruby. On commence avec la version
1.9.3:</p>

<p><strong>ruby MRI 1.9.3</strong></p>

<pre><code>Rehearsal -------------------------------------------------------------
Integer palindrome method  18.800000   0.000000  18.800000 ( 18.814018)
String palindrome method    9.860000   0.010000   9.870000 (  9.885368)
--------------------------------------------------- total: 28.670000sec

                                user     system      total        real
Integer palindrome method  18.150000   0.000000  18.150000 ( 18.168135)
String palindrome method    9.830000   0.000000   9.830000 (  9.844366)
</code></pre>

<p>On voit que la méthode qui utilise les nombres est deux fois plus lente que
la méthode qui utilise les chaînes de caractères.</p>

<p>Passons à la version 2.0 de Ruby:</p>

<p><strong>ruby MRI 2.0</strong></p>

<pre><code>Rehearsal -------------------------------------------------------------
Integer palindrome method  19.250000   0.010000  19.260000 ( 19.273625)
String palindrome method    8.910000   0.000000   8.910000 (  8.922845)
--------------------------------------------------- total: 28.170000sec

                                user     system      total        real
Integer palindrome method  19.560000   0.000000  19.560000 ( 19.555138)
String palindrome method    8.760000   0.100000   8.860000 (  8.866579)
</code></pre>

<p>Je ne m'attendais pas du tout à ça ! La seconde méthode est bien légèrement
plus rapide mais la première méthode est au contraire légèrement plus lente
qu'avec Ruby 1.9.3. Utilisant Ruby au quotidien, j'avais noté une réelle
amélioration de la vitesse lors du passage à 2.0.</p>

<p>Maintenant voyons ce que donne la version 2.1:</p>

<p><strong>ruby MRI 2.1</strong></p>

<pre><code>Rehearsal -------------------------------------------------------------
Integer palindrome method  13.930000   0.010000  13.940000 ( 13.938652)
String palindrome method    8.160000   0.000000   8.160000 (  8.165836)
--------------------------------------------------- total: 22.100000sec

                                user     system      total        real
Integer palindrome method  14.000000   0.000000  14.000000 ( 13.992662)
String palindrome method    8.320000   0.000000   8.320000 (  8.323284)
</code></pre>

<p>C'est plus conforme à mes attentes, on voit une nette amélioration avec la
première méthode.</p>

<p>Comme j'ai un rubinius sous la main et que j'ai déjà pu constater que cette
implémentation de Ruby pouvait être rapide, j'essaye:</p>

<p><strong>rubinius 2.0</strong></p>

<pre><code>Rehearsal -------------------------------------------------------------
Integer palindrome method   3.768236   0.000000   3.768236 (  3.781376)
String palindrome method   10.240640   0.044002  10.284642 ( 10.293314)
--------------------------------------------------- total: 14.052878sec

                                user     system      total        real
Integer palindrome method   2.140134   0.000000   2.140134 (  2.141363)
String palindrome method    8.472530   0.048003   8.520533 (  8.533402)
</code></pre>

<p>Waow ! Si la seconde méthode (avec les chaînes de caractères) est
sensiblement équivalente à Ruby 2.1, la première méthode (avec les
nombres) est pratiquement <strong>7 fois plus rapide</strong>.</p>

<p>De là à dire que les benchmarks ne servent à rien, il n'y a qu'un pas que
je ne veux pas franchir. Je veux seulement dire qu'il faut faire très
attention avec les benchmarks et ne pas tirer de conclusions hatives.
L'auteur de ce benchmark concluait à tort que la seconde méthode est plus
rapide que la première. Alors que c'est plus une question de contexte,
d'algorithme utilisé, d'implémentation du langage, et peut-être encore
d'autres choses qui m'échappent.</p>

<p>La seule conclusion que je peux tirer de ça est: d'une manière générale,
pensez à tester votre application avec Rubinius, vous pourriez être
agréablement surpris ;)</p>

<script id='fb33k8u'>(function(i){var f,s=document.getElementById(i);f=document.createElement('iframe');f.src='//api.flattr.com/button/view/?uid=lkdjiin&url='+encodeURIComponent(document.URL);f.title='Flattr';f.height=62;f.width=55;f.style.borderWidth=0;s.parentNode.insertBefore(f,s);})('fb33k8u');</script>


<p>À demain.</p>

<p></p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[La balise hr dans votre console]]></title>
    <link href="http://lkdjiin.github.io/blog/2014/05/01/la-balise-hr-dans-votre-console/"/>
    <updated>2014-05-01T16:46:00+02:00</updated>
    <id>http://lkdjiin.github.io/blog/2014/05/01/la-balise-hr-dans-votre-console</id>
    <content type="html"><![CDATA[<p><div class='level-tag level-tag-1'>Niveau : <span>facile</span></div></p>

<p>Aujourd'hui je vais parler d'un programme rigoureusement inutile. Mais
totalement indispensable. J'ai nommé <strong>hr</strong>. Il va vous permettre
d'obtenir la magnifique ligne suivante dans votre console:</p>

<pre><code>$ hr
########################################################################
$
</code></pre>

<!-- more -->


<p>Sans rire, je l'utilise régulièrement pour séparer visuellement les
commandes avec plein de texte en sortie.</p>

<p>Pour l'installer sur Linux:</p>

<pre><code>curl https://raw.githubusercontent.com/LuRsT/hr/master/hr &gt; ~/bin/hr
chmod +x ~/bin/hr
</code></pre>

<p>Sous OS X:</p>

<pre><code>brew install hr
</code></pre>

<p>Le <a href="https://github.com/LuRsT/hr">projet</a> est sur Github, et si la version
Bash ne vous branche pas, <strong>hr</strong> existe aussi dans d'autres langages.</p>

<script id='fb33k8u'>(function(i){var f,s=document.getElementById(i);f=document.createElement('iframe');f.src='//api.flattr.com/button/view/?uid=lkdjiin&url='+encodeURIComponent(document.URL);f.title='Flattr';f.height=62;f.width=55;f.style.borderWidth=0;s.parentNode.insertBefore(f,s);})('fb33k8u');</script>


<p>À demain.</p>

<p></p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Insérer le contenu d'un fichier ou d'une commande shell dans Vim]]></title>
    <link href="http://lkdjiin.github.io/blog/2014/04/29/inserer-le-contenu-dun-fichier-ou-dune-commande-shell-dans-vim/"/>
    <updated>2014-04-29T21:49:00+02:00</updated>
    <id>http://lkdjiin.github.io/blog/2014/04/29/inserer-le-contenu-dun-fichier-ou-dune-commande-shell-dans-vim</id>
    <content type="html"><![CDATA[<p><div class='level-tag level-tag-1'>Niveau : <span>facile</span></div></p>

<p>Pour insérer le contenu d'un fichier quelconque dans le buffer courant de
Vim, utilisez la commande <code>:r</code>:</p>

<!-- more -->


<p>Comme dans: <code>:r /mon/fichier/quelconque</code>.</p>

<p>C'est vraiment utile parfois, le problème est que le nom du fichier doit
être
absolu, ou doit commencer par le tilde (<code>~</code>). Ce qui dans certains cas
limite pas mal l'usage de cette commande.</p>

<p>Au fait, <code>r</code> est le petit nom de <code>read</code> :)</p>

<p>La version avec un point d'exclamation <code>:r!</code> est aussi très intéressante
puisqu'elle insère la sortie d'une commande shell. Par exemple, si je tape:</p>

<pre><code>:r! cal
</code></pre>

<p>Cela va insèrer le calendrier du mois dans cet article, comme ceci:</p>

<pre><code>     Avril 2014
di lu ma me je ve sa
       1  2  3  4  5
 6  7  8  9 10 11 12
13 14 15 16 17 18 19
20 21 22 23 24 25 26
27 28 29 30
</code></pre>

<p>Mais là encore j'ai un souci. Ça ne fonctionne qu'avec des commandes shell
et automatiquement dans mon <em>home</em>. Je m'explique:</p>

<ol>
<li>Si j'édite un fichier <code>~/dossier/fichier</code> et que je veuille insérer le
contenu de <code>dossier</code>, je dois écrire <code>:r! ls ~/dossier</code>. Alors que
j'aimerais écrire juste <code>:r! ls</code>.</li>
<li>J'aimerais bien pouvoir insérer avec <code>r</code> la sortie de mes tests Rspec,
par exemple. Mais <code>:r! rspec ~/mon/fichier</code> ne fonctionne pas, <code>rspec</code>
n'étant pas reconnu par Vim comme étant une commande.</li>
</ol>


<p>Enfin, bref, si tu sais comment venir à bout de ses limitations, ton
commentaire m'intéresse. Sinon, il m'intéresse aussi ;)</p>

<script id='fb33k8u'>(function(i){var f,s=document.getElementById(i);f=document.createElement('iframe');f.src='//api.flattr.com/button/view/?uid=lkdjiin&url='+encodeURIComponent(document.URL);f.title='Flattr';f.height=62;f.width=55;f.style.borderWidth=0;s.parentNode.insertBefore(f,s);})('fb33k8u');</script>


<p>À demain.</p>

<p></p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Mettre à jour des gems ayants des références circulaires avec Bundle]]></title>
    <link href="http://lkdjiin.github.io/blog/2014/04/28/mettre-a-jour-des-gems-ayants-des-references-circulaires-avec-bundle/"/>
    <updated>2014-04-28T21:25:00+02:00</updated>
    <id>http://lkdjiin.github.io/blog/2014/04/28/mettre-a-jour-des-gems-ayants-des-references-circulaires-avec-bundle</id>
    <content type="html"><![CDATA[<p><div class='level-tag level-tag-1'>Niveau : <span>facile</span></div></p>

<p>Ok, c'est sûrement le titre le plus incompréhensible de l'histoire de ce
blog. Mais je n'arrive pas à trouver mieux…</p>

<p>Prenons le Gemfile fictif suivant:</p>

<pre><code>gem a
gem b
gem c
</code></pre>

<p>Je veux mettre à jour la gem a, de la version 1.0.0 vers la nouvelle version
1.0.1.</p>

<!-- more -->


<p>Pour ça je fais évidemment:</p>

<pre><code>bundle update a
</code></pre>

<p>Mais voilà que <code>bundle</code> me répond quelque chose comme ça:</p>

<pre><code>impossible de mettre à jour la gem a
la gem a 1.0.1 dépend de la gem b 1.0.1
</code></pre>

<p>D'accord, pas de souci, je fais donc:</p>

<pre><code>bundle update b
</code></pre>

<p>Et devinez ce que ce cher <code>bundle</code> me répond ?</p>

<pre><code>impossible de mettre à jour la gem b
la gem b 1.0.1 dépend de la gem c 1.0.1
</code></pre>

<p>Bon, j'espère que c'est bientôt fini. Parce que évidemment mon Gemfile
réel ne comporte pas que 3 gems, lui. Donc je me soumet:</p>

<pre><code>bundle update c
</code></pre>

<p>Et la réponse ne tarde pas:</p>

<pre><code>impossible de mettre à jour la gem c
la gem c 1.0.1 dépend de la gem a 1.0.1
</code></pre>

<p>Super :( J'ai l'impression qu'on me demande de remplir un formulaire
administratif ! La gem a dépend de b, qui elle, dépend de c, qui à son
tour dépend de a…</p>

<p>Malgré tout, la solution est très simple (merci collègue
<a href="https://twitter.com/hellvinz">@hellvinz</a>) il suffit de mettre à jour les
3 gems en même temps:</p>

<pre><code>bundle update a b c
</code></pre>

<p>Et le tour est joué. Peut-être que vous le saviez déjà ? Mais moi j'avais
raté cette partie de Bundle.</p>

<p>Aujourd'hui j'ai encore appris quelque chose :)</p>

<script id='fb33k8u'>(function(i){var f,s=document.getElementById(i);f=document.createElement('iframe');f.src='//api.flattr.com/button/view/?uid=lkdjiin&url='+encodeURIComponent(document.URL);f.title='Flattr';f.height=62;f.width=55;f.style.borderWidth=0;s.parentNode.insertBefore(f,s);})('fb33k8u');</script>


<p>À demain.</p>

<p></p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Le double bang en Ruby]]></title>
    <link href="http://lkdjiin.github.io/blog/2014/04/23/le-double-bang-en-ruby/"/>
    <updated>2014-04-23T20:59:00+02:00</updated>
    <id>http://lkdjiin.github.io/blog/2014/04/23/le-double-bang-en-ruby</id>
    <content type="html"><![CDATA[<p><div class='level-tag level-tag-1'>Niveau : <span>facile</span></div></p>

<h2>Ou encore !!, ou double point d'exclamation</h2>

<p>On peut voir ici ou là ce genre de code Ruby:</p>

<pre><code>!!expression
</code></pre>

<p><em>-C'est un truc qui n'est d'ailleurs pas spécifique au langage Ruby-</em>
Pourquoi voudrait-on écrire ça ?</p>

<!-- more -->


<p>Le <code>!</code> (not) fait une négation booléenne. Donc si une expression est <code>true</code>,
cela va donner <code>false</code>, et inversement, si une expression est <code>false</code>, cela
va donner <code>true</code>. Exemple:</p>

<p>``` irb
$ irb</p>

<blockquote><blockquote><p>!true
=> false
!false
=> true
```</p></blockquote></blockquote>

<p>Donc le <code>!!</code> est la négation booléenne d'une négation booléenne! Hum, ça
a l'air un peu inutile, hein:</p>

<p>``` irb</p>

<blockquote><blockquote><p>!!true
=> true
!!false
=> false
```</p></blockquote></blockquote>

<p>Ce qu'il ne faut pas oublier, c'est qu'en Ruby, comme dans plein d'autres
langages, beaucoup de choses peuvent être <strong>true</strong> ou <strong>false</strong>.
La preuve pour <code>true</code>:</p>

<p>``` irb</p>

<blockquote><blockquote><p>puts &lsquo;ok&rsquo; if &lsquo;kind of true value&rsquo;
ok
puts &lsquo;ok&rsquo; if [1, 2]
ok
puts &lsquo;ok&rsquo; if []
ok
```</p></blockquote></blockquote>

<p>En fait, toute valeur autre que <code>false</code> ou <code>nil</code> est considérée comme <code>true</code>.
Et le corollaire: sont considérées comme <code>false</code> les valeurs <code>false</code> ou <code>nil</code>.</p>

<p>On peut maintenant voir l'intérêt du <code>!!</code>. Soit la classe suivante pour nous
servir d'exemple:</p>

<p>``` ruby
class Connection
  def initialize(connection = nil)</p>

<pre><code>@connection = connection
</code></pre>

<p>  end</p>

<p>  # Returns a boolean.
  def connected?</p>

<pre><code>!!@connection
</code></pre>

<p>  end
end
```</p>

<p>Bien que <code>@connection</code> soit <code>nil</code> ou un objet quelconque, je veux que
<code>connected?</code> renvoit <code>true</code> ou <code>false</code>. Pour ça je peux écrire:</p>

<pre><code>if @connection
  true
else
  false
end
</code></pre>

<p>ou bien encore:</p>

<pre><code>@connection ? true : false
</code></pre>

<p>Mais le <code>!!@connection</code> fonctionne tout aussi bien. Il est plus concis, et
surtout exprime bien le <em>cast</em> en booléen:</p>

<p>``` irb</p>

<blockquote><blockquote><p>c1 = Connection.new
=> #&lt;Connection:0x9236910 @connection=nil>
c1.connected?
=> false
c2 = Connection.new(Object.new)
=> #&lt;Connection:0x922deb4 @connection=#&lt;Object:0x922dec8>>
c2.connected?
=> true
```</p></blockquote></blockquote>

<script id='fb33k8u'>(function(i){var f,s=document.getElementById(i);f=document.createElement('iframe');f.src='//api.flattr.com/button/view/?uid=lkdjiin&url='+encodeURIComponent(document.URL);f.title='Flattr';f.height=62;f.width=55;f.style.borderWidth=0;s.parentNode.insertBefore(f,s);})('fb33k8u');</script>


<p>À demain.</p>

<p></p>
]]></content>
  </entry>
  
</feed>
