<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">

  <title><![CDATA[Catégorie : diff | lkdjiin's blog]]></title>
  <link href="http://lkdjiin.github.io/blog/categories/diff/atom.xml" rel="self"/>
  <link href="http://lkdjiin.github.io/"/>
  <updated>2014-12-17T16:45:47+01:00</updated>
  <id>http://lkdjiin.github.io/</id>
  <author>
    <name><![CDATA[Xavier Nayrac]]></name>
    
  </author>
  <generator uri="http://octopress.org/">Octopress</generator>

  
  <entry>
    <title type="html"><![CDATA[Une histoire de git diff]]></title>
    <link href="http://lkdjiin.github.io/blog/2014/06/05/une-histoire-de-git-diff/"/>
    <updated>2014-06-05T21:17:00+02:00</updated>
    <id>http://lkdjiin.github.io/blog/2014/06/05/une-histoire-de-git-diff</id>
    <content type="html"><![CDATA[<p><div class='level-tag level-tag-2'>Niveau : <span>intermédiaire</span></div></p>

<p>Je devais fusionner notre branche <code>development</code> dans la branche
<code>master</code> et envoyer cette nouvelle version en production.</p>

<p>Mais avant d'envoyer quoi que ce soit, en production ou même sur Github,
je lance toujours la suite de tests. Vu notre <em>workflow</em>, quand il s'agit
de <em>merger</em> <code>development</code> dans <code>master</code>, c'est plus une formalité, une
habitude, qu'autre chose.</p>

<p>Sauf que cette fois-ci, certains tests ne passaient pas.</p>

<!-- more -->


<p>Comme je l'ai dit, vu notre <em>workflow</em>, c'est normalement impossible !
À moins que…</p>

<p>À moins qu'un collêgue &ndash;<em> pas moi bien sûr ;) </em>&ndash; ai fusionné un <em>hotfix</em>
dans <code>master</code> et oublié de le mettre dans <code>development</code> ? Vu qu'on déploit
plusieurs fois par semaines, ça a été vite à controler. C'était pas ça…</p>

<p>En regardant de plus près ce que racontaient les tests qui échouaient, j'ai
remarqué un truc très bizarre. Une des lignes d'où était sensée partir
l'erreur dans le code était … vide ! <code>Rspec</code> me disait que l'erreur partait
de la ligne 6, alors qu'elle partait en réalité de la ligne 7 ! Et c'est pas
tout, <code>Rspec</code> me soutenait que j'envoyais deux arguments à telle méthode
(c'était ça les erreurs), alors
qu'en réalité j'en envoyais bien un seul ! J'avais le code sous les yeux !</p>

<p>Qui mentait ? <code>Rspec</code> ou le code ?</p>

<p>C'est là qu'intervient la commande Git du titre de cet article, si vous avez
lu jusqu'ici.</p>

<pre><code>git diff master..development
</code></pre>

<p>Ça m'a permis de voir les différences entre les deux branches. Il y avait
simplement un fichier qui avait été déplacé et remanié. Seulement l'ancienne
version de ce fichier était elle aussi toujours là, à son ancien emplacement.</p>

<p>Après la suppression de ce fichier indélicat, j'ai pu envoyer le tout
en production. Je ne sais toujours pas pourquoi il y avait cette différence.
Je n'ai pas eu (<em>pris ?</em>) le temps de chercher. Enfin bref, merci Git :)</p>

<script id='fb33k8u'>(function(i){var f,s=document.getElementById(i);f=document.createElement('iframe');f.src='//api.flattr.com/button/view/?uid=lkdjiin&url='+encodeURIComponent(document.URL);f.title='Flattr';f.height=62;f.width=55;f.style.borderWidth=0;s.parentNode.insertBefore(f,s);})('fb33k8u');</script>


<p>À demain.</p>

<p></p>
]]></content>
  </entry>
  
</feed>
