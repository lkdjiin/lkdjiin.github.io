<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">

  <title><![CDATA[Catégorie : bug | Xavier Nayrac]]></title>
  <link href="http://lkdjiin.github.io/blog/categories/bug/atom.xml" rel="self"/>
  <link href="http://lkdjiin.github.io/"/>
  <updated>2019-11-03T16:19:20+01:00</updated>
  <id>http://lkdjiin.github.io/</id>
  <author>
    <name><![CDATA[Xavier Nayrac]]></name>
    
  </author>
  <generator uri="http://octopress.org/">Octopress</generator>

  
  <entry>
    <title type="html"><![CDATA[Bug de la version graphique de Vim sur Debian Sid]]></title>
    <link href="http://lkdjiin.github.io/blog/2016/11/11/bug-de-la-version-graphique-de-vim-sur-debian-sid/"/>
    <updated>2016-11-11T09:46:00+01:00</updated>
    <id>http://lkdjiin.github.io/blog/2016/11/11/bug-de-la-version-graphique-de-vim-sur-debian-sid</id>
    <content type="html"><![CDATA[<p>Depuis une mise à jour récente de la bibliothèque gtk3 un
bug affecte la version graphique de Vim (<code>gvim</code>) sur Debian Sid. Ce bug est
important puisqu’il rend <code>gvim</code> tout simplement inutilisable. Lorsqu’on lance
le programme on obtient le message suivant, qui se répète plusieurs fois :</p>

<pre><code>$ gvim

(gvim:6054): Gtk-CRITICAL **: gtk_widget_set_size_request: assertion 'width &gt;= -1' failed
*** BUG ***
In pixman_region32_init_rect: Invalid rectangle passed
Set a breakpoint on '_pixman_log_error' to debug
.
.
.
</code></pre>

<p>Des discussions sont en cours pour savoir si le bug est de la responsabilité
de Vim ou de Gtk3, mais en attendant on fait quoi ?</p>

<!-- more -->

<p>On peut d’abord regarder où est placée la commande <code>gvim</code> :</p>

<p><code>bash
$ which gvim
/usr/bin/gvim
</code></p>

<p>On peut maintenant regarder quel programme est en réalité appelé par cette
commande (j’ai tronqué la sortie pour laisser seulement ce qui est
intéressant).  On voit que <code>gvim</code> est un lien symbolique qui pointe sur
<code>/etc/alternatives/gvim</code> :</p>

<p><code>bash
$ ls -l /usr/bin/gvim
[...] /usr/bin/gvim -&gt; /etc/alternatives/gvim*
</code></p>

<p>Allons voir sur quel programme est <em>branché</em> l’alternative :</p>

<p><code>bash
$ ls -l /etc/alternatives/gvim
[...] /etc/alternatives/gvim -&gt; /usr/bin/vim.gtk3*
</code></p>

<p>Ça fait sens. Regardons quelles <em>versions</em> de vim sont disponibles en tapant
<code>vim</code> + tab :</p>

<p><code>bash
$ vim
vim        vim.basic  vimdiff    vim.gtk    vim.gtk3   vim.tiny   vimtutor 
</code></p>

<p>L’ancienne version (<code>vim.gtk</code>) m’intéresse. Si vous ne l’avez pas/plus, vous
pouvez l’installer avec <code>apt-get install vim-gtk</code>.</p>

<h2 id="solution-n1">Solution n°1</h2>

<p>Un tour dans l’aide de <code>vim.gtk</code> montrera qu’on peut le lancer avec l’option <code>-g</code>
pour avoir l’interface graphique. En attendant que le bug soit réparé on peut
donc utiliser <code>vim.gtk -g</code> à la place de <code>gvim</code>.</p>

<h2 id="solution-n2">Solution n°2</h2>

<p>Le programme <code>update-alternatives</code> permet de gérer ce genre de problème
facilement. Utilisez le pour choisir ce que lancera la commande <code>gvim</code> :</p>

<pre><code>$ sudo update-alternatives --config gvim
[sudo] Mot de passe de xavier : 
Il existe 2 choix pour l'alternative gvim (qui fournit /usr/bin/gvim).

  Sélection   Chemin             Priorité  État
------------------------------------------------------------
* 0            /usr/bin/vim.gtk3   50        mode automatique
  1            /usr/bin/vim.gtk    50        mode manuel
  2            /usr/bin/vim.gtk3   50        mode manuel

Appuyez sur &lt;Entrée&gt; pour conserver la valeur par défaut[*] ou choisissez le numéro sélectionné :1
</code></pre>

<p>Vous pourriez préférer la version graphique <code>galternatives</code>.</p>

<p></p>
]]></content>
  </entry>
  
</feed>
