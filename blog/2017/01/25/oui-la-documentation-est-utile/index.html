<!DOCTYPE html>
<html lang="fr"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" href="/assets/main.css"><link type="application/atom+xml" rel="alternate" href="http://lkdjiin.github.io/atom.xml" title="Xavier Nayrac" /></head>
<body><header class="site-header" role="banner">

  <div class="wrapper"><a class="site-title" rel="author" href="/">Xavier Nayrac</a><nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger"><a class="page-link" href="/about/">À propos</a></div>
      </nav></div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">Oui la documentation est utile</h1>
    <p class="post-meta">
      <time class="dt-published" datetime="2017-01-25T11:13:00+01:00" itemprop="datePublished">25 January 2017
      </time></p>
  </header>

  <div class="post-content e-content" itemprop="articleBody">
    <p>J’ai lu récemment un article de blog intitulé
<a href="https://blog.nathanaelcherrier.com/2017/01/11/les-meilleurs-commentaires-ne-secrivent-pas/">Les meilleurs commentaires ne s’écrivent pas</a>.
Le titre est bon. Le sujet est intéressant. Les
intentions de l’auteur sont louables.</p>

<p>Malgré cela, cet article m’a laissé perplexe. Je pense que l’auteur se méprend.
Et comme le sujet m’est important et qu’on ne peut pas laisser de commentaires
sur son blog, j’ai eu envie d’écrire un article pour lui répondre.</p>

<p>Je reprendrai les même titres de partie que l’article original pour vous
permettre de vous repérer plus facilement si besoin.</p>

<!-- more -->

<h2 id="self-documenting-code">Self Documenting Code</h2>

<p>L’article commence par comparer deux bouts de code qui ont le même objectif. Le
premier est mauvais, avec un commentaire nécessaire pour expliquer l’objectif.
Le second est meilleur, et se passe donc d’un commentaire.</p>

<p><em>code 1</em></p>

<figure class="highlight"><pre><code class="language-js" data-lang="js"><span class="c1">// Get the extension off the image filename</span>
<span class="kd">let</span> <span class="nx">pieces</span> <span class="o">=</span> <span class="nx">imageName</span><span class="p">.</span><span class="nx">split</span><span class="p">(</span><span class="dl">'</span><span class="s1">.</span><span class="dl">'</span><span class="p">)</span>
<span class="kd">let</span> <span class="nx">extension</span> <span class="o">=</span> <span class="nx">pieces</span><span class="p">.</span><span class="nx">pop</span><span class="p">()</span></code></pre></figure>

<p><em>code 2</em></p>

<figure class="highlight"><pre><code class="language-js" data-lang="js"><span class="kd">let</span> <span class="nx">extension</span> <span class="o">=</span> <span class="nx">getFileExtension</span><span class="p">(</span><span class="nx">imageName</span><span class="p">)</span></code></pre></figure>

<p>Je suis entièrement d’accord avec la conclusion de cette première partie de
l’article :</p>

<blockquote>
  <p>Le nom d’une fonction est déjà censé répondre à la question de ce que fait
une portion de code. Pourquoi ne pas utiliser cette possibilité ?</p>
</blockquote>

<p>Oui le nommage des fonctions/variables/classes/toussa est très important. À tel
point que je pense que c’est une des premières compétences à acquérir pour un/e
débutant/e.</p>

<p>Bref, jusqu’ici je suis entièrement d’accord. C’est après que ça se gâte.</p>

<h2 id="trop-de-commentaires-étouffe-le-code">Trop de commentaires étouffe le code</h2>

<p>Dans cette partie de l’article l’auteur prend le code suivant comme exemple:</p>

<figure class="highlight"><pre><code class="language-js" data-lang="js"><span class="cm">/**
 * Get the extension of the file
 * 
 * @param {string} filename - The filename
 * @return {string} the extension of the file  
 */</span>
<span class="kd">function</span> <span class="nx">getFileExtension</span><span class="p">(</span><span class="nx">filename</span><span class="p">)</span> <span class="p">{</span>  
  <span class="kd">let</span> <span class="nx">pieces</span> <span class="o">=</span> <span class="nx">filename</span><span class="p">.</span><span class="nx">split</span><span class="p">(</span><span class="dl">'</span><span class="s1">.</span><span class="dl">'</span><span class="p">)</span>
  <span class="k">return</span> <span class="nx">pieces</span><span class="p">.</span><span class="nx">pop</span><span class="p">()</span>
<span class="p">}</span></code></pre></figure>

<p>Dès le début de cette seconde partie,
un truc me gène beaucoup : l’auteur continue d’appeler ça du
«commentaire» alors qu’il s’agit de «documentation». Certain(e)s diront que je
pinaille, mais pour moi il s’agit d’une différence très importante. Voyons ce
qu’en pense le Larousse par exemple:</p>

<p><strong>Commentaire</strong>: <em>Exposé par lequel on explique, on interprète, on juge un
texte ; notes et éclaircissements destinés à faciliter l’intelligence d’un
texte.</em></p>

<p><strong>Documentation</strong>: <em>Ensemble de documents fournis avec un appareil, un jeu, un
programme informatique, etc., et donnant des renseignements sur leur structure,
leur fonctionnement, leur utilisation, etc.</em></p>

<p>Un commentaire sert donc à faciliter la compréhension d’un texte (pour nous un
bout de code informatique), alors qu’une documentation explique comment ça
marche. Peu importe si on pense que ces définitions ne s’appliquent pas
parfaitement à notre métier, ce qui compte c’est de comprendre que leurs
objectifs sont différents.</p>

<p>J’ai gardé ce sentiment dérangeant jusqu’au bout de l’article, qui entretient un flou
artistique autour du duo commentaire/documentation.</p>

<p>L’auteur se plaint ensuite que, dans un projet en cours:</p>

<blockquote>
  <p>[…] la plupart des commentaires écrits sont des commentaires qui n’existent
que pour passer les tests. Ils sont redondants &amp; inutiles.</p>
</blockquote>

<p>En voyant le code donné plus haut en exemple, on peut comprendre sa position.
<em>Je</em> peux aisément comprendre. Mais la plainte ne me semble pas clairement formulée. Qui est
responsable, selon l’auteur ? L’outil ?
Des collègues qui ne jouent pas le jeu ?
Le management qui impose un process trop strict ?
Ça m’intéresserais beaucoup de connaître le sentiment de l’auteur à ce sujet,
car j’ai l’impression que l’article blâme la documentation alors que le
problème est ailleurs.</p>

<p>L’article continue ainsi:</p>

<blockquote>
  <p>Dites moi qu’il y a une information dans ce commentaire que vous n’aviez pas
en lisant le code !</p>
</blockquote>

<p>Oui je le dis ;) J’en ai une. Et même deux ! Une première sur les types, ce qui
est toujours bon à prendre avec un langage dynamique. Je vois que ça
fonctionne avec une chaîne de caractère, et pas avec un objet File ou Path ou
autre chose encore qui aurait du sens dans mon langage, dans mon framework, etc.
Et j’ai une
seconde information sur l’importance relative de cette méthode : si elle mérite une telle
documentation c’est sûrement qu’elle est destinée à être utilisée par d’autres
objets appartenant à d’autres classes. Autrement dit elle est publique et son
usage n’est pas réservé à une utilisation interne.</p>

<p>Il faut bien avouer que l’exemple donné est assez déprimant. Comme l’auteur le
souligne il y a une certaine redondance, c’est le moins qu’on puisse dire.
Si je devais écrire ce genre de choses
toute la journée j’aurai vite besoin de vacances. Et je comprends que ça le rende
marteau, et qu’il ne puisse plus voir ce genre particulier de documentation en peinture.</p>

<p>Mais ce qui me dérange ici, c’est que ça à tout l’air d’un exemple factice.
Ce code n’est pas destiné à aller en production. Par exemple, il se passe quoi
si le nom du fichier est <code class="language-plaintext highlighter-rouge">.bashrc</code>, ou <code class="language-plaintext highlighter-rouge">foobar</code> ? Bin ça marche pas.
Tirer une conclusion générale d’un exemple factice, c’est pour le moins
hasardeux.</p>

<p>Surtout que même en l’état actuel de la fonction, cette documentation
pourrait être largement améliorée. J’ai pris la liberté de modifier le
style pour un que je trouve plus léger, mais l’important est dans la
reformulation, pas dans le style.  Je me suis inspiré des documentations de
méthodes similaires trouvées dans d’autres langages:</p>

<figure class="highlight"><pre><code class="language-js" data-lang="js"><span class="c1">// Get the extension (the portion of filename starting from the last period).</span>
<span class="c1">//</span>
<span class="c1">// filename - The filename (as a string) to retrieve the extension of.</span>
<span class="c1">//</span>
<span class="c1">// Returns the extension of the file as a string. Or the filename itself</span>
<span class="c1">// if it has no dots. Or the filename without the dot if it starts with </span>
<span class="c1">// a dot and don't have another one.</span>
<span class="kd">function</span> <span class="nx">getFileExtension</span><span class="p">(</span><span class="nx">filename</span><span class="p">)</span> <span class="p">{</span>  
  <span class="kd">let</span> <span class="nx">pieces</span> <span class="o">=</span> <span class="nx">filename</span><span class="p">.</span><span class="nx">split</span><span class="p">(</span><span class="dl">'</span><span class="s1">.</span><span class="dl">'</span><span class="p">)</span>
  <span class="k">return</span> <span class="nx">pieces</span><span class="p">.</span><span class="nx">pop</span><span class="p">()</span>
<span class="p">}</span></code></pre></figure>

<p>Bon d’accord, je me suis un peu amusé à la fin. Mais
on voit qu’il y a de quoi dire. Il y a moins de redondance. Et on a bien
plus d’informations, sans avoir besoin d’aller les extraire du code.</p>

<p>L’auteur conclu cette partie en disant qu’on fini par ne plus voir les
commentaires (<em>je rappelle qu’on parle en fait de documentation</em>) dans les projets
où il y en a de trop. Mais je ne pense pas que ça soit un problème, bien au
contraire. Je dirais même qu’avec une bonne coloration syntaxique, la documentation est
encore moins <em>présente</em>, je peux l’oublier encore plus facilement. <strong>Et c’est très bien ainsi.</strong>
La documentation est très utile, mais seulement de temps en temps. Dans ces
moments là, elle permet de gagner un temps précieux. Le reste du temps, elle doit
savoir se faire oublier. Et si j’en ai envie, mon éditeur de texte, ou mon IDE,
doit même pouvoir la faire disparaitre et réapparaitre à ma guise.</p>

<h2 id="la-couverture-par-la-documentation">La couverture par la documentation</h2>

<p>L’article évoque ensuite des outils qui calculent le taux de couverture de la documentation.
Et comme quoi la course aux 100% est problématique.</p>

<p>C’est un tout autre débat, qui mériterait au moins un second article en réponse ;)
Mais qu’on soit d’accord ou pas, là, on blâme clairement l’outil plutôt que l’utilisateur.</p>

<p>Plus loin l’auteur poursuit :</p>

<blockquote>
  <p>pour la documentation un haut taux de couverture est contre-productif et étouffe le code</p>
</blockquote>

<p>???</p>

<p><em>Contre productif</em> ? Permettre aux utilisateurs de votre code, ou à vous même dans
1 an, dans 3 ans, de comprendre le code en un claquement de doigt serait
<em>contre productif</em> ? On écrit le code (et sa documentation) <strong>une fois</strong>, et on les
lit <strong>des dizaines de fois</strong>. Et ça serait <em>contre productif</em> de faciliter cette
lecture ?</p>

<p><em>Étouffe le code</em> ? L’auteur nous a expliqué dans la partie précédente qu’il ne
les voyait plus, ces commentaires/documentation, qu’ils devenaient invisibles
pour lui. Je ne comprend pas comment ça peut-être à la fois invisible et étouffant.
 Mais dans tout les cas, même si je rate quelque chose et au risque de me répéter :
votre éditeur/IDE doit être capable de masquer la documentation si celle-ci vous
gène, sinon il faut changer d’éditeur.</p>

<blockquote>
  <p>Là où le code est propre le commentaire ne sera qu’une redondance sans grand intérêt</p>
</blockquote>

<p>J’ai démontré le contraire.</p>

<blockquote>
  <p>Là où le code est sale le développeur pourra utiliser le commentaire comme une
excuse pour laisser le code sale</p>
</blockquote>

<p>Mais WHAT ?</p>

<p>D’après ce que j’ai saisi, l’auteur travaille au sein d’une équipe. Et l’équipe
fait des <em>code reviews</em>, non ? Si oui, c’est de la responsabilité de <em>l’équipe</em>
de ne pas laisser passer de code sale. Ça n’est en rien la faute de la documentation, ou d’un commentaire,
ou d’un outil quelconque.
Si non, et bien comment dire, c’est juste que j’arrive pas à imaginer un endroit où on ne fait
pas de <em>code review</em>. Je sais que ça existe, j’ai même du y bosser, mais je ne me
souviens plus comment c’est. Plus sérieusement, si il n’y a pas de <em>code review</em> c’est pas
d’écrire ou non de la doc qui va changer grand chose à la <em>propreté</em> du code.
Et dans ce cas la responsabilité irait à l’auteur du code, pas à la documentation.</p>


  </div>

  <br/>
  <br/>
  <div style="text-align: center">/ / / / / / / / / /</div>
  <br/>
  <br/>

  <div style="text-align: center">
    
      <a href="/blog/2017/01/20/retour-sur-le-mooc-programmer-en-c/" title="Article précédent: Retour sur le MOOC Programmer en C">&laquo; Retour sur le MOOC Programmer en C</a> ---//---
    
    
      <a href="/blog/2017/02/26/clojure-tests-et-couleurs/" title="Article suivant: Clojure, tests et couleurs">Clojure, tests et couleurs &raquo;</a>
    
  </div>

  <br/>
  <br/><a class="u-url" href="/blog/2017/01/25/oui-la-documentation-est-utile/" hidden></a>
</article>

      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/"></data>

  <div class="wrapper">

    <div>
    <p class="rss-subscribe">s'abonner <a href="/atom.xml">via RSS</a></p>
    </div>

    <h2 class="footer-heading">Xavier Nayrac</h2>

    <div class="footer-col-wrapper">
      <div class="footer-col footer-col-1">
        <ul class="contact-list">
          <li class="p-name">
            Copyright 2013 - 2025
            </li><li><a class="u-email" href="mailto:"></a></li></ul>
      </div>

      <div class="footer-col footer-col-2"><ul class="social-media-list">

  <li>
    <a href="https://github.com/lkdjiin">
      <img src="/images/github.png" />
      <span class="username">lkdjiin</span>
    </a>
  </li>

  <li>
    <a href="https://ruby.social/@lkdjiin">
      <img src="/images/mastodon.png" />
      <span class="username">lkdjiin</span>
    </a>
  </li>

  <li>
    <a href="/atom.xml">
      <img src="/images/atom.png" />
      <span class="username">RSS</span>
    </a>
  </li>
</ul>
</div>

      <div class="footer-col footer-col-3">
        <p>Dev accro au TDD, brasseur d&#39;appartement, musicien, maker, ex créateur d&#39;effets pour guitare, heureux utilisateur de Vim.</p>
      </div>
    </div>

  </div>

</footer>
</body>

</html>
