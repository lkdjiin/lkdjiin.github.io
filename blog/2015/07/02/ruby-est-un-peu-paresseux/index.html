
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>Ruby est un peu paresseux - Xavier Nayrac</title>
  <meta name="author" content="Xavier Nayrac">

  
  <meta name="description" content="Niveau : intermédiaire Voici un mécanisme interne du langage Ruby démontré le temps d’une petite session irb. D’abord, créons la variable a, qui va &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://lkdjiin.github.io/blog/2015/07/02/ruby-est-un-peu-paresseux">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <link href="/atom.xml" rel="alternate" title="Xavier Nayrac" type="application/atom+xml">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
  <script>!window.jQuery && document.write(unescape('%3Cscript src="./javascripts/lib/jquery.min.js"%3E%3C/script%3E'))</script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="http://fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="http://fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">


</head>

<body   >
  <header role="banner"><a href="/">
  <img src="http://www.gravatar.com/avatar/f6d0dff2dbb2fdc08fb1318116ea572c?s=140"/>
</a>
<h1><a href="/">Xavier Nayrac</a></h1>
<h2>
  Accro au TDD, rubyiste mais pas que, maker, heureux utilisateur de Vim.<br/>
  Si vous vous sentez particulièrement généreux,
  <a href="https://twitter.com/lkdjiin">suivez moi sur Twitter</a>.
</h2>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS"><img src="/images/rss.png"></img>
    RSS</a></li>
  
</ul>
  
<form action="http://google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="sitesearch" value="lkdjiin.github.io">
    <input class="search" type="text" name="q" results="0" placeholder="Chercher"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
  <li><a href="/">Blog</a></li>
  <li><a href="/blog/archives">Archives</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div>
<article class="hentry" role="article">
  
  <header>
    
      <h1 class="entry-title">Ruby est un peu paresseux</h1>
    
    
      <p class="meta">
        








  


<time datetime="2015-07-02T17:17:00+02:00" pubdate data-updated="true">2 juillet 2015</time>
        
         | <a href="#disqus_thread">Comments</a>
        
      </p>
    
  </header>


<div class="entry-content"><div class="level-tag level-tag-2">Niveau : <span>intermédiaire</span></div>

<p>Voici un mécanisme interne du langage Ruby démontré le temps d’une petite session irb.</p>

<p>D’abord, créons la variable <code>a</code>, qui va contenir la chaîne <code>"one"</code> :</p>

<div class="bogus-wrapper"><notextile><figure class="code"><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
</pre></td><td class="code"><pre><code class="irb"><span class="line"><span class="go">$ irb</span>
</span><span class="line"><span class="gp">&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="s2">&quot;one&quot;</span>
</span><span class="line"><span class="go">&quot;one&quot;</span>
</span></code></pre></td></tr></table></div></figure></notextile></div>

<p>Créons ensuite la variable <code>b</code>, qui va contenir ce que contient la variable <code>a</code>,
c’est à dire aussi <code>"one"</code> :</p>

<div class="bogus-wrapper"><notextile><figure class="code"><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
</pre></td><td class="code"><pre><code class="irb"><span class="line"><span class="gp">&gt;&gt; </span><span class="n">b</span> <span class="o">=</span> <span class="n">a</span>
</span><span class="line"><span class="go">&quot;one&quot;</span>
</span></code></pre></td></tr></table></div></figure></notextile></div>

<p>Question : est ce que les variables <code>a</code> et <code>b</code> partagent le même emplacement en
mémoire ? </p>

<!-- more -->

<p>Et bien oui, <code>b = a</code> n’a pas copié la <em>valeur</em> de <code>a</code> dans <code>b</code>, mais a assigné
à <code>b</code> la même case mémoire que <code>a</code> :</p>

<div class="bogus-wrapper"><notextile><figure class="code"><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
<span class="line-number">6</span>
</pre></td><td class="code"><pre><code class="irb"><span class="line"><span class="gp">&gt;&gt; </span><span class="n">a</span><span class="o">.</span><span class="n">object_id</span> <span class="o">==</span> <span class="n">b</span><span class="o">.</span><span class="n">object_id</span>
</span><span class="line"><span class="go">true</span>
</span><span class="line"><span class="gp">&gt;&gt; </span><span class="n">a</span><span class="o">.</span><span class="n">object_id</span>
</span><span class="line"><span class="go">81895060</span>
</span><span class="line"><span class="gp">&gt;&gt; </span><span class="n">b</span><span class="o">.</span><span class="n">object_id</span>
</span><span class="line"><span class="go">81895060</span>
</span></code></pre></td></tr></table></div></figure></notextile></div>

<p>Mais alors si on change la valeur de la variable <code>a</code>, ça va changer aussi celle
de <code>b</code> ? Et non :</p>

<div class="bogus-wrapper"><notextile><figure class="code"><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
<span class="line-number">6</span>
</pre></td><td class="code"><pre><code class="irb"><span class="line"><span class="gp">&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="s2">&quot;two&quot;</span>
</span><span class="line"><span class="go">&quot;two&quot;</span>
</span><span class="line"><span class="gp">&gt;&gt; </span><span class="n">a</span><span class="o">.</span><span class="n">object_id</span> <span class="o">==</span> <span class="n">b</span><span class="o">.</span><span class="n">object_id</span>
</span><span class="line"><span class="go">false</span>
</span><span class="line"><span class="gp">&gt;&gt; </span><span class="n">b</span>
</span><span class="line"><span class="go">&quot;one&quot;</span>
</span></code></pre></td></tr></table></div></figure></notextile></div>

<p>L’emplacement mémoire a été modifié. On a maintenant deux variables bien
distinctes :</p>

<div class="bogus-wrapper"><notextile><figure class="code"><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
</pre></td><td class="code"><pre><code class="irb"><span class="line"><span class="gp">&gt;&gt; </span><span class="n">a</span><span class="o">.</span><span class="n">object_id</span>
</span><span class="line"><span class="go">81648680</span>
</span><span class="line"><span class="gp">&gt;&gt; </span><span class="n">b</span><span class="o">.</span><span class="n">object_id</span>
</span><span class="line"><span class="go">81895060</span>
</span></code></pre></td></tr></table></div></figure></notextile></div>

<p>Tant qu’il n’y a pas de modification de l’une ou de l’autre des variables, Ruby
agit en quelque sorte comme si il n’y en avait qu’une seule. J’imagine que c’est
pour soulager l’utilisation de la mémoire.</p>

<p>Mais dès que l’une ou l’autre est modifiée, les deux variables deviennent bien
distinctes.</p>

<div class="bogus-wrapper"><notextile><figure class="code"><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
</pre></td><td class="code"><pre><code class="irb"><span class="line"><span class="gp">&gt;&gt; </span><span class="nb">exit</span>
</span></code></pre></td></tr></table></div></figure></notextile></div>

<section><h1>Articles connexes</h1><ul><li><a href="/blog/2015/06/30/comportement-inattendu-de-rspec/">Comportement inattendu de Rspec</a></li><li><a href="/blog/2015/04/30/le-hack-fizzbuzz-en-ruby/">Le hack FizzBuzz en Ruby</a></li><li><a href="/blog/2015/02/04/une-machine-de-turing-en-ruby-la-routine-de-copie/">Une machine de Turing en Ruby - La routine de copie</a></li></ul></section>
</div>


  <footer>
    <p class="meta">
      
  

<span class="byline author vcard">Posté par <span class="fn">Xavier Nayrac</span></span>

      








  


<time datetime="2015-07-02T17:17:00+02:00" pubdate data-updated="true">2 juillet 2015</time>
      

<span class="categories">
  
    <a class='category' href='/blog/categories/intermediaire/'>intermédiaire</a>, <a class='category' href='/blog/categories/optimisation/'>optimisation</a>, <a class='category' href='/blog/categories/ruby/'>ruby</a>
  
</span>


    </p>
    
      <div class="sharing">
  
  
  
</div>

    
    <p class="meta">
      
        <a class="basic-alignment left" href="/blog/2015/06/30/comportement-inattendu-de-rspec/" title="Previous Post: Comportement inattendu de Rspec">&laquo; Comportement inattendu de Rspec</a>
      
      
        <a class="basic-alignment right" href="/blog/2015/07/08/ce-blog-a-2-ans/" title="Next Post: Ce blog à 2 ans">Ce blog à 2 ans &raquo;</a>
      
    </p>
  </footer>
</article>

  <section>
    <h1>Commentaires</h1>
    <div id="disqus_thread" aria-live="polite"><noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</div>
  </section>

</div>

<aside class="sidebar">
  
    <section>
  <h1>Articles récents</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/blog/2018/08/30/heroku-ovh-les-naked-domains-et-les-dns/">Heroku, OVH, les naked domains, et les DNS</a>
      </li>
    
      <li class="post">
        <a href="/blog/2018/08/21/comment-creer-votre-propre-localisation-sous-linux/">Comment créer votre propre localisation sous Linux</a>
      </li>
    
      <li class="post">
        <a href="/blog/2018/07/27/gopher-recuperer-le-menu-principal/">Gopher : Récupérer le menu principal</a>
      </li>
    
      <li class="post">
        <a href="/blog/2018/07/21/presentation-de-gopher/">Présentation de Gopher</a>
      </li>
    
      <li class="post">
        <a href="/blog/2018/02/14/lister-un-dossier-tout-en-nettoyant-lecran/">Lister un dossier tout en nettoyant l'écran</a>
      </li>
    
      <li class="post">
        <a href="/blog/2017/02/28/fish-completion-puis-execution-en-une-seule-fois/">Fish : complétion puis exécution en une seule fois</a>
      </li>
    
      <li class="post">
        <a href="/blog/2017/02/26/clojure-tests-et-couleurs/">Clojure, tests et couleurs</a>
      </li>
    
      <li class="post">
        <a href="/blog/2017/01/25/oui-la-documentation-est-utile/">Oui la documentation est utile</a>
      </li>
    
      <li class="post">
        <a href="/blog/2017/01/20/retour-sur-le-mooc-programmer-en-c/">Retour sur le MOOC Programmer en C</a>
      </li>
    
      <li class="post">
        <a href="/blog/2016/12/20/retour-du-mooc-designer-dans-un-fablab/">Retour du MOOC Designer dans un fablab</a>
      </li>
    
      <li class="post">
        <a href="/blog/2016/12/13/changer-de-shell-de-bash-a-fish/">Changer de shell, de Bash à Fish</a>
      </li>
    
      <li class="post">
        <a href="/blog/2016/11/11/bug-de-la-version-graphique-de-vim-sur-debian-sid/">Bug de la version graphique de Vim sur Debian Sid</a>
      </li>
    
      <li class="post">
        <a href="/blog/2016/11/02/comment-ecrire-un-framework-de-test-pour-ruby/">Comment écrire un framework de test pour Ruby</a>
      </li>
    
      <li class="post">
        <a href="/blog/2016/08/04/comment-mettre-a-jour-un-package-r/">Comment mettre à jour un package R</a>
      </li>
    
      <li class="post">
        <a href="/blog/2016/08/02/12-points-pour-rater-la-conception-dun-mooc/">12 points pour rater la conception d'un MOOC</a>
      </li>
    
      <li class="post">
        <a href="/blog/2016/05/08/ecrire-un-jeu-en-2d-avec-ruby-et-gosu-partie-8/">Écrire un jeu en 2d avec Ruby et Gosu - partie 8</a>
      </li>
    
      <li class="post">
        <a href="/blog/2016/05/01/ecrire-un-jeu-en-2d-avec-ruby-et-gosu-partie-7/">Écrire un jeu en 2d avec Ruby et Gosu - partie 7</a>
      </li>
    
      <li class="post">
        <a href="/blog/2016/02/25/ecrire-un-jeu-en-2d-avec-ruby-et-gosu-partie-6/">Écrire un jeu en 2d avec Ruby et Gosu - partie 6</a>
      </li>
    
      <li class="post">
        <a href="/blog/2016/02/15/ecrire-un-jeu-en-2d-avec-ruby-et-gosu-partie-5/">Écrire un jeu en 2d avec Ruby et Gosu - partie 5</a>
      </li>
    
      <li class="post">
        <a href="/blog/2016/02/13/ecrire-un-jeu-en-2d-avec-ruby-et-gosu-partie-4/">Écrire un jeu en 2d avec Ruby et Gosu - partie 4</a>
      </li>
    
  </ul>
</section>

  
</aside>


    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2018 - Xavier Nayrac -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>

<script type="text/javascript">
  var user = "xavier";
  var i = document.createElement("img");
  i.src = "http://52.47.87.39/boomerang/visit/" + user;
</script>


</footer>
  

<script type="text/javascript">
      var disqus_shortname = 'confessionsdeveloppeur';
      
        
        // var disqus_developer = 1;
        var disqus_identifier = 'http://lkdjiin.github.io/blog/2015/07/02/ruby-est-un-peu-paresseux/';
        var disqus_url = 'http://lkdjiin.github.io/blog/2015/07/02/ruby-est-un-peu-paresseux/';
        var disqus_script = 'embed.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'http://' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>


<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  tex2jax: {inlineMath: [['\\(','\\)']]}
});
</script>
<script src='https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML'></script>


</body>
</html>
