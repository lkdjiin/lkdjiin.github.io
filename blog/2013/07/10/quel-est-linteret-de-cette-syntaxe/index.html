
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>Quel est l'intérêt de cette syntaxe ? - lkdjiin's blog</title>
  <meta name="author" content="Xavier Nayrac">

  
  <meta name="description" content="Niveau : intermédiaire En googlant sur ruby design pattern factory je suis tombé sur un
post intéressant.
Non, je ne vais pas vous parler de design &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://lkdjiin.github.io/blog/2013/07/10/quel-est-linteret-de-cette-syntaxe">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <link href="/atom.xml" rel="alternate" title="lkdjiin's blog" type="application/atom+xml">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
  <script>!window.jQuery && document.write(unescape('%3Cscript src="./javascripts/lib/jquery.min.js"%3E%3C/script%3E'))</script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="http://fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="http://fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">


  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-39286891-4']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>


</head>

<body   >
  <header role="banner"><img src="http://www.gravatar.com/avatar/f6d0dff2dbb2fdc08fb1318116ea572c"/>
<hgroup>
  <h1><a href="/">lkdjiin's blog</a></h1>
  
    <h2>Confessions d'un développeur.</h2>
  
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<form action="http://google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="q" value="site:lkdjiin.github.io" />
    <input class="search" type="text" name="q" results="0" placeholder="Chercher"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
  <li><a href="/">Blog</a></li>
  <li><a href="/blog/archives">Archives</a></li>
  <li><a href="/articles-par-genre">Articles par genre</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div>
<article class="hentry" role="article">
  
  <header>
    
      <h1 class="entry-title">Quel est l'intérêt de cette syntaxe ?</h1>
    
    
      <p class="meta">
        








  


<time datetime="2013-07-10T09:04:00+02:00" pubdate data-updated="true">10 juillet 2013</time>
        
         | <a href="#disqus_thread">Comments</a>
        
      </p>
    
  </header>


<div class="entry-content"><div class='level-tag level-tag-2'>Niveau : <span>intermédiaire</span></div>


<p>En googlant sur <code>ruby design pattern factory</code> je suis tombé sur un
<a href="http://blog.rubybestpractices.com/posts/gregory/059-issue-25-creational-design-patterns.html">post intéressant</a>.
Non, je ne vais pas vous parler de design pattern dans cet article. L&#8217;exemple
qui m&#8217;a plus particulierment intrigué est le suivant:</p>

<figure class='code'><figcaption><span>Exemple original</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="k">class</span> <span class="nc">AdjacencyMatrix</span>
</span><span class='line'>  <span class="k">class</span> <span class="o">&lt;&lt;</span> <span class="nb">self</span>
</span><span class='line'>    <span class="k">def</span> <span class="nf">undirected</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</span><span class='line'>      <span class="kp">new</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</span><span class='line'>    <span class="k">end</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">def</span> <span class="nf">directed</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</span><span class='line'>      <span class="kp">new</span><span class="p">(</span><span class="n">data</span><span class="p">,</span><span class="kp">true</span><span class="p">)</span>
</span><span class='line'>    <span class="k">end</span>
</span><span class='line'>
</span><span class='line'>    <span class="kp">private</span> <span class="ss">:new</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">def</span> <span class="nf">initialize</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">directed</span><span class="o">=</span><span class="kp">false</span><span class="p">)</span>
</span><span class='line'>    <span class="c1">#...  </span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'><span class="k">end</span>
</span><span class='line'>
</span><span class='line'><span class="n">undirected_matrix</span> <span class="o">=</span> <span class="no">AdjacencyMatrix</span><span class="o">.</span><span class="n">undirected</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</span><span class='line'><span class="n">directed_matrix</span>   <span class="o">=</span> <span class="no">AdjacencyMatrix</span><span class="o">.</span><span class="n">directed</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</span></code></pre></td></tr></table></div></figure>


<p>Pourquoi cet exemple m&#8217;a intrigué ? Pas parce qu&#8217;il parle de matrice, je vous
rassure. Je ne comprends pas grand chose aux matrices, et je n&#8217;ai jamais
entendu parler d&#8217;«adjacency matrix». Si cet exemple m&#8217;intrigue, c&#8217;est parce que
je ne comprends pas, <em>à priori</em>, l&#8217;intérêt du <code>class &lt;&lt; self</code>.  Il me semble
que je peux réécrire ça sans <code>class &lt;&lt; self</code> et que le résultat serait le même.</p>

<!-- more -->


<p>Alors allons y. Voilà le nouveau bout de code qui fait la même chose que
le précédent:</p>

<figure class='code'><figcaption><span>Seconde version</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="k">class</span> <span class="nc">AdjacencyMatrix</span>
</span><span class='line'>  <span class="k">def</span> <span class="nc">self</span><span class="o">.</span><span class="nf">undirected</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</span><span class='line'>    <span class="kp">new</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">def</span> <span class="nc">self</span><span class="o">.</span><span class="nf">directed</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</span><span class='line'>    <span class="kp">new</span><span class="p">(</span><span class="n">data</span><span class="p">,</span><span class="kp">true</span><span class="p">)</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'>
</span><span class='line'>  <span class="nb">private_class_method</span> <span class="ss">:new</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">def</span> <span class="nf">initialize</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">directed</span><span class="o">=</span><span class="kp">false</span><span class="p">)</span>
</span><span class='line'>    <span class="c1">#...  </span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'><span class="k">end</span>
</span><span class='line'>
</span><span class='line'><span class="n">undirected_matrix</span> <span class="o">=</span> <span class="no">AdjacencyMatrix</span><span class="o">.</span><span class="n">undirected</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</span><span class='line'><span class="n">directed_matrix</span>   <span class="o">=</span> <span class="no">AdjacencyMatrix</span><span class="o">.</span><span class="n">directed</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</span></code></pre></td></tr></table></div></figure>


<p><span class='pullquote-right' data-pullquote='un code plus simple est un code plus
maintenable,'>
L&#8217;API et le résultat sont identiques. Alors c&#8217;est pas nouveau, avec Ruby il y a
toujours deux (ou trois, ou plus) manières différentes de faire la même chose.
Mais là, je me demande plus particulièrment si il y a un <strong>intérêt</strong> à utiliser
la syntaxe du premier exemple. Et je ne vois pas.  Du coup il me vient une
seconde question : entre ces deux exemples, quel est le meilleur code ? Et part
<em>meilleur</em>, j&#8217;entends bien sûr <em>le plus lisible</em>.<br/>
Sans vous faire attendre plus
longtemps, je pense que le second exemple possède le code le plus lisible.
Pourquoi ? Parce qu&#8217;il est plus simple ? Non, parce que ça n&#8217;est pas forcement
très pertinent dans ce cas précis.
Même si je pense que 9 fois sur 10 un code plus simple est un code plus
maintenable, je dois reconnaitre que quelqu&#8217;un d&#8217;habitué à manipuler du code
Ruby comprendra aussi facilement et rapidement les deux syntaxes précédentes.
</span></p>

<p><span class='pullquote-right' data-pullquote='je voudrais lire du code aussi facilement et naturellement que je lis
un livre'>
En fait, si le second
exemple me parait plus lisible, c&#8217;est parce qu&#8217;il possède un niveau
d&#8217;indentation du code en moins. Plus on est proche de la marge gauche, et plus
le code se lit aisément. C&#8217;est pas toujours évident à voir
sur des exemples aussi courts, c&#8217;est vrai. Mais quand on lit du code, comme
celui de l&#8217;exemple 1, étalé sur une centaine de lignes ou plus, il est facile
de se perdre et/ou d&#8217;oublier si on a affaire à une méthode de classe ou à une
méthode d&#8217;objet.
Un code devrait pouvoir se lire comme une histoire. Pour pousser la logique,
je voudrais lire du code aussi facilement et naturellement que je lis
un livre. Et dans un
livre, les lignes débutent à la marge gauche. Voilà pourquoi je préfère le
code du second exemple.
</span></p>

<h2>Quel est l&#8217;intérêt de <code>class &lt;&lt; self</code> ?</h2>

<p>Quoi qu&#8217;il en soit, je n&#8217;ai toujours pas de réponse à ma première question:
«quel est l&#8217;intérêt de <code>class &lt;&lt; self</code>» dans cet exemple précis.
Il est possible que dans une ancienne
version de Ruby, il n&#8217;y avait pas moyen de faire autrement et qu&#8217;on ai gardé
l&#8217;habitude ? Peut-être qu&#8217;il n&#8217;y a aucune réponse ? Je vais donc aller faire un
tour du coté de la divinité StackOverflow pour tenter d&#8217;y voir plus clair. Je
vous tient au courant dans un futur article si je trouve quelque chose.</p>

<script id='fb33k8u'>(function(i){var f,s=document.getElementById(i);f=document.createElement('iframe');f.src='//api.flattr.com/button/view/?uid=lkdjiin&url='+encodeURIComponent(document.URL);f.title='Flattr';f.height=62;f.width=55;f.style.borderWidth=0;s.parentNode.insertBefore(f,s);})('fb33k8u');</script>


<p>À demain.</p>

<p><section><h1>Articles connexes</h1><ul><li><a href='/blog/2014/03/03/ecrire-un-editeur-pour-le-terminal-partie-6/'>Écrire un éditeur pour le terminal &ndash; partie 6</a></li><li><a href='/blog/2014/03/02/ecrire-un-editeur-pour-le-terminal-partie-5/'>Écrire un éditeur pour le terminal &ndash; partie 5</a></li><li><a href='/blog/2014/03/01/ecrire-un-editeur-pour-le-terminal-partie-4/'>Écrire un éditeur pour le terminal &ndash; partie 4</a></li></ul></section></p>
</div>


  <footer>
    <p class="meta">
      
  

<span class="byline author vcard">Posté par <span class="fn">Xavier Nayrac</span></span>

      








  


<time datetime="2013-07-10T09:04:00+02:00" pubdate data-updated="true">10 juillet 2013</time>
      

<span class="categories">
  
    <a class='category' href='/blog/categories/code-propre/'>code propre</a>, <a class='category' href='/blog/categories/intermediaire/'>intermédiaire</a>, <a class='category' href='/blog/categories/ruby/'>ruby</a>
  
</span>


    </p>
    
      <div class="sharing">
  
  <a href="//twitter.com/share" class="twitter-share-button" data-url="http://lkdjiin.github.io/blog/2013/07/10/quel-est-linteret-de-cette-syntaxe/" data-via="lkdjiin" data-counturl="http://lkdjiin.github.io/blog/2013/07/10/quel-est-linteret-de-cette-syntaxe/" >Tweet</a>
  
  
  <div class="g-plusone" data-size="medium"></div>
  
  
    <div class="fb-like" data-send="true" data-width="450" data-show-faces="false"></div>
  
</div>

    
    <p class="meta">
      
        <a class="basic-alignment left" href="/blog/2013/07/09/bien-debuter-avec-vim-conseil-numero-un/" title="Previous Post: Bien débuter avec Vim: conseil numéro un">&laquo; Bien débuter avec Vim: conseil numéro un</a>
      
      
        <a class="basic-alignment right" href="/blog/2013/07/11/ruby-et-les-eigenclass/" title="Next Post: Ruby et les eigenclass">Ruby et les eigenclass &raquo;</a>
      
    </p>
  </footer>
</article>

  <section>
    <h1>Comments</h1>
    <div id="disqus_thread" aria-live="polite"><noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</div>
  </section>

</div>

<aside class="sidebar">
  
    <section>
  <h1>À propos</h1>
  <p>Blog ouvert sept jours sur sept, j'écris
  <a href="http://lkdjiin.github.io/blog/2013/07/08/nouveau-defi-un-article-par-jour-pendant-un-an/">un article par jour</a>
  sur divers sujets, notamment Vim, Ruby et les algorithmes génétiques.<br/>
  Si vous vous sentez particulièrement généreux,
  <a href="https://twitter.com/lkdjiin">suivez moi sur Twitter</a>.
  </p>
</section>
<section>
  <h1>Articles récents</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/blog/2014/03/04/ecrire-un-editeur-pour-le-terminal-partie-7/">Écrire un éditeur pour le terminal - partie 7</a>
      </li>
    
      <li class="post">
        <a href="/blog/2014/03/03/ecrire-un-editeur-pour-le-terminal-partie-6/">Écrire un éditeur pour le terminal - partie 6</a>
      </li>
    
      <li class="post">
        <a href="/blog/2014/03/02/ecrire-un-editeur-pour-le-terminal-partie-5/">Écrire un éditeur pour le terminal - partie 5</a>
      </li>
    
      <li class="post">
        <a href="/blog/2014/03/01/ecrire-un-editeur-pour-le-terminal-partie-4/">Écrire un éditeur pour le terminal - partie 4</a>
      </li>
    
      <li class="post">
        <a href="/blog/2014/02/28/filtrer-ses-logs-en-direct/">Filtrer ses logs en direct</a>
      </li>
    
      <li class="post">
        <a href="/blog/2014/02/27/la-commande-cat-peut-aussi-afficher-les-numeros-de-lignes/">La commande cat peut aussi afficher les numéros de lignes</a>
      </li>
    
      <li class="post">
        <a href="/blog/2014/02/26/de-linux-debian-vers-os-x-supprimer-un-fichier-dans-le-finder/">De Linux (Debian) vers OS X - Supprimer un fichier dans le finder</a>
      </li>
    
  </ul>
</section>


  
</aside>


    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2014 - Xavier Nayrac -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>

</footer>
  

<script type="text/javascript">
      var disqus_shortname = 'confessionsdeveloppeur';
      
        
        // var disqus_developer = 1;
        var disqus_identifier = 'http://lkdjiin.github.io/blog/2013/07/10/quel-est-linteret-de-cette-syntaxe/';
        var disqus_url = 'http://lkdjiin.github.io/blog/2013/07/10/quel-est-linteret-de-cette-syntaxe/';
        var disqus_script = 'embed.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'http://' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>



<div id="fb-root"></div>
<script>(function(d, s, id) {
  var js, fjs = d.getElementsByTagName(s)[0];
  if (d.getElementById(id)) {return;}
  js = d.createElement(s); js.id = id; js.async = true;
  js.src = "//connect.facebook.net/en_US/all.js#appId=212934732101925&xfbml=1";
  fjs.parentNode.insertBefore(js, fjs);
}(document, 'script', 'facebook-jssdk'));</script>



  <script type="text/javascript">
    (function() {
      var script = document.createElement('script'); script.type = 'text/javascript'; script.async = true;
      script.src = 'https://apis.google.com/js/plusone.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(script, s);
    })();
  </script>



  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = '//platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>





</body>
</html>
