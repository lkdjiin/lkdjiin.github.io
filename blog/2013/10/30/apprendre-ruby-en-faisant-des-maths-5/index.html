
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>Apprendre Ruby en faisant des maths 5 - Xavier Nayrac</title>
  <meta name="author" content="Xavier Nayrac">

  
  <meta name="description" content="Niveau : facile Jusqu’ici on a écrit une méthode qui calcule les diviseurs d’un nombre et
une seconde méthode qui calcule les diviseurs stricts. &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://lkdjiin.github.io/blog/2013/10/30/apprendre-ruby-en-faisant-des-maths-5">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <link href="/atom.xml" rel="alternate" title="Xavier Nayrac" type="application/atom+xml">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
  <script>!window.jQuery && document.write(unescape('%3Cscript src="./javascripts/lib/jquery.min.js"%3E%3C/script%3E'))</script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="http://fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="http://fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">


</head>

<body   >
  <header role="banner"><a href="/">
  <img src="http://www.gravatar.com/avatar/f6d0dff2dbb2fdc08fb1318116ea572c?s=140"/>
</a>
<h1><a href="/">Xavier Nayrac</a></h1>
<h2>
  Accro au TDD, rubyiste mais pas que, maker, heureux utilisateur de Vim.<br/>
  Si vous vous sentez particulièrement généreux,
  <a href="https://twitter.com/lkdjiin">suivez moi sur Twitter</a>.
</h2>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS"><img src="/images/rss.png"></img>
    RSS</a></li>
  
</ul>
  
<form action="http://google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="sitesearch" value="lkdjiin.github.io">
    <input class="search" type="text" name="q" results="0" placeholder="Chercher"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
  <li><a href="/">Blog</a></li>
  <li><a href="/blog/archives">Archives</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div>
<article class="hentry" role="article">
  
  <header>
    
      <h1 class="entry-title">Apprendre Ruby en faisant des maths 5</h1>
    
    
      <p class="meta">
        








  


<time datetime="2013-10-30T19:15:00+01:00" pubdate data-updated="true">30 octobre 2013</time>
        
         | <a href="#disqus_thread">Comments</a>
        
      </p>
    
  </header>


<div class="entry-content"><div class="level-tag level-tag-1">Niveau : <span>facile</span></div>

<p>Jusqu’ici on a écrit une méthode qui calcule les diviseurs d’un nombre et
une seconde méthode qui calcule les diviseurs stricts.
Notre objectif étant de lister les nombres amiables jusqu’à 10 000, il nous
faut maintenant obtenir la <em>somme</em> des diviseurs stricts d’un nombre.</p>

<!-- more -->

<p>Il nous faut donc calculer la somme des nombres qui composent une liste.
Allons y, prenons une liste et plaçons la dans une variable nommée <code>x</code>:</p>

<div class="bogus-wrapper"><notextile><figure class="code"><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
</pre></td><td class="code"><pre><code class="irb"><span class="line"><span class="gp">&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="o">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="o">]</span>
</span><span class="line"><span class="go">=&gt; [1, 2, 4]</span>
</span></code></pre></td></tr></table></div></figure></notextile></div>

<p>Nous avons déjà vu la méthode <code>select</code>, qui sélectionne certains éléments
d’une liste ; nous allons voir maintenant la méthode <code>reduce</code>, qui va <em>réduire</em>
les éléments d’une liste à <em>un seul</em> élément:</p>

<div class="bogus-wrapper"><notextile><figure class="code"><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
</pre></td><td class="code"><pre><code class="irb"><span class="line"><span class="gp">&gt;&gt; </span><span class="n">x</span><span class="o">.</span><span class="n">reduce</span> <span class="p">{</span><span class="o">|</span><span class="n">sum</span><span class="p">,</span> <span class="n">int</span><span class="o">|</span> <span class="n">sum</span> <span class="o">+</span> <span class="n">int</span><span class="p">}</span>
</span><span class="line"><span class="go">=&gt; 7</span>
</span></code></pre></td></tr></table></div></figure></notextile></div>

<p>Contrairement à la méthode <code>select</code> qui ne prenait qu’une seule variable
dans le bloc d’instruction, la méthode <code>reduce</code> en prends ici deux:
<code>sum</code> et <code>int</code>. <code>sum</code> joue le rôle d’un accumulateur et contient le résultat
qui sera retourné par la méthode. <code>int</code> fait référence à l’élément de la
liste en cours de traitement, exactement comme avec <code>select</code>. Pour chaque
élément de la liste <code>x</code>, l’instruction <code>sum + int</code> est exécutée.</p>

<p>On peut se demander quelle est la valeur initiale de <code>sum</code> ? Tout simplement
le premier élément de la liste. Et nous ne sommes pas limité aux nombres,
<code>reduce</code> fonctionnera avec ce qu’on veut, par exemple des chaînes de
caractères:</p>

<div class="bogus-wrapper"><notextile><figure class="code"><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
</pre></td><td class="code"><pre><code class="irb"><span class="line"><span class="gp">&gt;&gt; </span><span class="o">[</span><span class="s2">&quot;f&quot;</span><span class="p">,</span> <span class="s2">&quot;o&quot;</span><span class="p">,</span> <span class="s2">&quot;o&quot;</span><span class="o">].</span><span class="n">reduce</span> <span class="p">{</span><span class="o">|</span><span class="n">string</span><span class="p">,</span> <span class="n">letter</span><span class="o">|</span> <span class="n">string</span> <span class="o">+</span> <span class="n">letter</span><span class="p">}</span>
</span><span class="line"><span class="go">=&gt; &quot;foo&quot;</span>
</span></code></pre></td></tr></table></div></figure></notextile></div>

<p>Ruby permet aussi de simplifier l’écriture dans un cas trivial comme le
notre:</p>

<div class="bogus-wrapper"><notextile><figure class="code"><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
</pre></td><td class="code"><pre><code class="irb"><span class="line"><span class="gp">&gt;&gt; </span><span class="n">x</span><span class="o">.</span><span class="n">reduce</span><span class="p">(</span><span class="ss">:+</span><span class="p">)</span>
</span><span class="line"><span class="go">=&gt; 7</span>
</span></code></pre></td></tr></table></div></figure></notextile></div>

<p>En fait, <code>reduce</code> ne prend pas obligatoirement un bloc. Ci-dessus,
<code>reduce</code> prend
en argument un symbole: <code>:+</code>. <code>+</code> est le nom d’une méthode. Oui, <code>+</code> est
bien une méthode:</p>

<div class="bogus-wrapper"><notextile><figure class="code"><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
</pre></td><td class="code"><pre><code class="irb"><span class="line"><span class="gp">&gt;&gt; </span><span class="mi">1</span><span class="o">.</span><span class="n">+</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
</span><span class="line"><span class="go">=&gt; 3</span>
</span></code></pre></td></tr></table></div></figure></notextile></div>

<p>Je ne vais pas parler plus des symboles aujourd’hui, sachez seulement
que les deux écritures suivantes font la même chose mais que la seconde
est plus dans l’esprit de Ruby:</p>

<div class="bogus-wrapper"><notextile><figure class="code"><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
</pre></td><td class="code"><pre><code class="ruby"><span class="line"><span class="n">x</span><span class="o">.</span><span class="n">reduce</span> <span class="p">{</span><span class="o">|</span><span class="n">sum</span><span class="p">,</span> <span class="n">int</span><span class="o">|</span> <span class="n">sum</span> <span class="o">+</span> <span class="n">int</span><span class="p">}</span>
</span><span class="line"><span class="n">x</span><span class="o">.</span><span class="n">reduce</span><span class="p">(</span><span class="ss">:+</span><span class="p">)</span>
</span></code></pre></td></tr></table></div></figure></notextile></div>

<p>Voilà, on est prêt à implémenter la méthode <code>sum_of_proper_divisors</code>, ce
qui signifie en français «somme des diviseurs stricts»:</p>

<div class="bogus-wrapper"><notextile><figure class="code"><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
</pre></td><td class="code"><pre><code class="ruby"><span class="line"><span class="k">def</span> <span class="nf">sum_of_proper_divisors</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
</span><span class="line">  <span class="n">proper_divisors</span><span class="p">(</span><span class="n">n</span><span class="p">)</span><span class="o">.</span><span class="n">reduce</span><span class="p">(</span><span class="ss">:+</span><span class="p">)</span>
</span><span class="line"><span class="k">end</span>
</span></code></pre></td></tr></table></div></figure></notextile></div>

<p>Comme la dernière fois, on se sert d’une méthode plus générale
(<code>proper_divisors</code>) pour écrire une méthode plus spécifique.</p>

<div class="bogus-wrapper"><notextile><figure class="code"><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
<span class="line-number">6</span>
<span class="line-number">7</span>
<span class="line-number">8</span>
<span class="line-number">9</span>
<span class="line-number">10</span>
<span class="line-number">11</span>
<span class="line-number">12</span>
<span class="line-number">13</span>
<span class="line-number">14</span>
<span class="line-number">15</span>
<span class="line-number">16</span>
<span class="line-number">17</span>
<span class="line-number">18</span>
</pre></td><td class="code"><pre><code class="irb"><span class="line"><span class="gp">&gt;&gt; </span><span class="k">def</span> <span class="nf">divisors</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
</span><span class="line"><span class="gp">&gt;&gt; </span>  <span class="p">(</span><span class="mi">1</span><span class="o">.</span><span class="n">.n</span><span class="p">)</span><span class="o">.</span><span class="n">select</span> <span class="p">{</span><span class="o">|</span><span class="n">i</span><span class="o">|</span> <span class="n">n</span> <span class="o">%</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">0</span> <span class="p">}</span>
</span><span class="line"><span class="gp">&gt;&gt; </span><span class="k">end</span>
</span><span class="line"><span class="go">&gt;&gt;</span>
</span><span class="line"><span class="gp">&gt;&gt; </span><span class="k">def</span> <span class="nf">proper_divisors</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
</span><span class="line"><span class="gp">&gt;&gt; </span>  <span class="n">divisors</span><span class="p">(</span><span class="n">n</span><span class="p">)</span><span class="o">[</span><span class="mi">0</span><span class="o">.</span><span class="n">.</span><span class="o">-</span><span class="mi">2</span><span class="o">]</span>
</span><span class="line"><span class="gp">&gt;&gt; </span><span class="k">end</span>
</span><span class="line"><span class="go">&gt;&gt;</span>
</span><span class="line"><span class="gp">&gt;&gt; </span><span class="k">def</span> <span class="nf">sum_of_proper_divisors</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
</span><span class="line"><span class="gp">&gt;&gt; </span>  <span class="n">proper_divisors</span><span class="p">(</span><span class="n">n</span><span class="p">)</span><span class="o">.</span><span class="n">reduce</span><span class="p">(</span><span class="ss">:+</span><span class="p">)</span>
</span><span class="line"><span class="gp">&gt;&gt; </span><span class="k">end</span>
</span><span class="line"><span class="go">&gt;&gt;</span>
</span><span class="line"><span class="gp">&gt;&gt; </span><span class="n">divisors</span> <span class="mi">8</span>
</span><span class="line"><span class="go">=&gt; [1, 2, 4, 8]</span>
</span><span class="line"><span class="gp">&gt;&gt; </span><span class="n">proper_divisors</span> <span class="mi">8</span>
</span><span class="line"><span class="go">=&gt; [1, 2, 4]</span>
</span><span class="line"><span class="gp">&gt;&gt; </span><span class="n">sum_of_proper_divisors</span> <span class="mi">8</span>
</span><span class="line"><span class="go">=&gt; 7</span>
</span></code></pre></td></tr></table></div></figure></notextile></div>

<script id="fb33k8u">(function(i){var f,s=document.getElementById(i);f=document.createElement('iframe');f.src='//api.flattr.com/button/view/?uid=lkdjiin&url='+encodeURIComponent(document.URL);f.title='Flattr';f.height=62;f.width=55;f.style.borderWidth=0;s.parentNode.insertBefore(f,s);})('fb33k8u');</script>

<p>À demain.</p>

<section><h1>Articles connexes</h1><ul><li><a href="/blog/2013/11/17/racket-pour-les-rubyists-8-tests-unitaires-simples/">Racket pour les Rubyists 8: Tests unitaires simples</a></li><li><a href="/blog/2013/11/15/racket-pour-les-rubyists-7-module-basique/">Racket pour les Rubyists 7: Module basique</a></li><li><a href="/blog/2013/11/14/apprendre-ruby-en-faisant-des-maths-7-tests-unitaires-simples/">Apprendre Ruby en faisant des maths 7: Tests unitaires simples</a></li></ul></section>

</div>


  <footer>
    <p class="meta">
      
  

<span class="byline author vcard">Posté par <span class="fn">Xavier Nayrac</span></span>

      








  


<time datetime="2013-10-30T19:15:00+01:00" pubdate data-updated="true">30 octobre 2013</time>
      

<span class="categories">
  
    <a class='category' href='/blog/categories/debutant/'>débutant</a>, <a class='category' href='/blog/categories/ruby/'>ruby</a>, <a class='category' href='/blog/categories/tutoriel/'>tutoriel</a>
  
</span>


    </p>
    
      <div class="sharing">
  
  
  
</div>

    
    <p class="meta">
      
        <a class="basic-alignment left" href="/blog/2013/10/29/je-vais-apprendre-scheme/" title="Previous Post: Je vais apprendre Scheme">&laquo; Je vais apprendre Scheme</a>
      
      
        <a class="basic-alignment right" href="/blog/2013/10/31/installer-scheme/" title="Next Post: Installer Scheme">Installer Scheme &raquo;</a>
      
    </p>
  </footer>
</article>

  <section>
    <h1>Commentaires</h1>
    <div id="disqus_thread" aria-live="polite"><noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</div>
  </section>

</div>

<aside class="sidebar">
  
    <section>
  <h1>Articles récents</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/blog/2019/12/04/fabriquer-une-vactrol-pour-piloter-un-oscillateur/">Fabriquer une vactrol pour piloter un oscillateur</a>
      </li>
    
      <li class="post">
        <a href="/blog/2019/12/02/fonctionnement-dun-oscillateur-a-base-de-cd40106/">Fonctionnement d'un oscillateur à base de CD40106</a>
      </li>
    
      <li class="post">
        <a href="/blog/2019/11/20/quelques-oscillateurs-tres-simples/">Quelques oscillateurs très simples</a>
      </li>
    
      <li class="post">
        <a href="/blog/2019/11/10/le-format-eurorack/">Le format Eurorack</a>
      </li>
    
      <li class="post">
        <a href="/blog/2019/11/03/100-jours-de-synthe-modulaire/">100 jours de synthé modulaire</a>
      </li>
    
      <li class="post">
        <a href="/blog/2019/01/23/comparaison-de-deux-experiences-utilisateur/">Comparaison de deux expériences utilisateur</a>
      </li>
    
      <li class="post">
        <a href="/blog/2018/08/30/heroku-ovh-les-naked-domains-et-les-dns/">Heroku, OVH, les naked domains, et les DNS</a>
      </li>
    
      <li class="post">
        <a href="/blog/2018/08/21/comment-creer-votre-propre-localisation-sous-linux/">Comment créer votre propre localisation sous Linux</a>
      </li>
    
      <li class="post">
        <a href="/blog/2018/07/27/gopher-recuperer-le-menu-principal/">Gopher : Récupérer le menu principal</a>
      </li>
    
      <li class="post">
        <a href="/blog/2018/07/21/presentation-de-gopher/">Présentation de Gopher</a>
      </li>
    
      <li class="post">
        <a href="/blog/2018/02/14/lister-un-dossier-tout-en-nettoyant-lecran/">Lister un dossier tout en nettoyant l'écran</a>
      </li>
    
      <li class="post">
        <a href="/blog/2017/02/28/fish-completion-puis-execution-en-une-seule-fois/">Fish : complétion puis exécution en une seule fois</a>
      </li>
    
      <li class="post">
        <a href="/blog/2017/02/26/clojure-tests-et-couleurs/">Clojure, tests et couleurs</a>
      </li>
    
      <li class="post">
        <a href="/blog/2017/01/25/oui-la-documentation-est-utile/">Oui la documentation est utile</a>
      </li>
    
      <li class="post">
        <a href="/blog/2017/01/20/retour-sur-le-mooc-programmer-en-c/">Retour sur le MOOC Programmer en C</a>
      </li>
    
      <li class="post">
        <a href="/blog/2016/12/20/retour-du-mooc-designer-dans-un-fablab/">Retour du MOOC Designer dans un fablab</a>
      </li>
    
      <li class="post">
        <a href="/blog/2016/12/13/changer-de-shell-de-bash-a-fish/">Changer de shell, de Bash à Fish</a>
      </li>
    
      <li class="post">
        <a href="/blog/2016/11/11/bug-de-la-version-graphique-de-vim-sur-debian-sid/">Bug de la version graphique de Vim sur Debian Sid</a>
      </li>
    
      <li class="post">
        <a href="/blog/2016/11/02/comment-ecrire-un-framework-de-test-pour-ruby/">Comment écrire un framework de test pour Ruby</a>
      </li>
    
      <li class="post">
        <a href="/blog/2016/08/04/comment-mettre-a-jour-un-package-r/">Comment mettre à jour un package R</a>
      </li>
    
  </ul>
</section>

  
</aside>


    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2019 - Xavier Nayrac -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>

</footer>
  

<script type="text/javascript">
      var disqus_shortname = 'confessionsdeveloppeur';
      
        
        // var disqus_developer = 1;
        var disqus_identifier = 'http://lkdjiin.github.io/blog/2013/10/30/apprendre-ruby-en-faisant-des-maths-5/';
        var disqus_url = 'http://lkdjiin.github.io/blog/2013/10/30/apprendre-ruby-en-faisant-des-maths-5/';
        var disqus_script = 'embed.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'http://' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>


<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  tex2jax: {inlineMath: [['\\(','\\)']]}
});
</script>
<script src='https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML'></script>


</body>
</html>
