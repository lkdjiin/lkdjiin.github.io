
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>Code propre: Non aux abréviations - Xavier Nayrac</title>
  <meta name="author" content="Xavier Nayrac">

  
  <meta name="description" content="Niveau : facile Pour l’écriture du langage Naam,
je cherchais une implémentation toute
prête de l’algorithme Shunting Yard
en Ruby. Je suis tombé sur &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://lkdjiin.github.io/blog/2013/08/21/code-propre-non-aux-abreviations">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <link href="/atom.xml" rel="alternate" title="Xavier Nayrac" type="application/atom+xml">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
  <script>!window.jQuery && document.write(unescape('%3Cscript src="./javascripts/lib/jquery.min.js"%3E%3C/script%3E'))</script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="http://fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="http://fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">


  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-39286891-4']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>


</head>

<body   >
  <header role="banner"><a href="/">
  <img src="http://www.gravatar.com/avatar/f6d0dff2dbb2fdc08fb1318116ea572c?s=140"/>
</a>
<h1><a href="/">Xavier Nayrac</a></h1>
<h2>
  Rubyiste accro au TDD, serial blogger, heureux utilisateur de Vim,
  accordéonniste.<br/>
  Si vous vous sentez particulièrement généreux,
  <a href="https://twitter.com/lkdjiin">suivez moi sur Twitter</a>.
</h2>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS"><img src="/images/rss.png"></img>
    RSS</a></li>
  
</ul>
  
<form action="http://google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="sitesearch" value="lkdjiin.github.io">
    <input class="search" type="text" name="q" results="0" placeholder="Chercher"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
  <li><a href="/">Blog</a></li>
  <li><a href="/blog/archives">Archives</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div>
<article class="hentry" role="article">
  
  <header>
    
      <h1 class="entry-title">Code propre: Non aux abréviations</h1>
    
    
      <p class="meta">
        








  


<time datetime="2013-08-21T14:46:00+02:00" pubdate data-updated="true">21 août 2013</time>
        
         | <a href="#disqus_thread">Comments</a>
        
      </p>
    
  </header>


<div class="entry-content"><div class="level-tag level-tag-1">Niveau : <span>facile</span></div>

<p>Pour l’écriture du 
<a href="http://lkdjiin.github.io/blog/2013/08/01/implementer-un-langage-sur-la-machine-virtuelle-parrot-partie-1/">langage Naam</a>,
je cherchais une implémentation toute
prête de l’algorithme 
<a href="http://en.wikipedia.org/wiki/Shunting_yard_algorithm">Shunting Yard</a>
en Ruby. Je suis tombé sur
<a href="http://www.hokstad.com/operator-precedence-parser">cet article</a>
qui a retenu mon attention car l’auteur propose en plus
la sortie dans un arbre syntaxique. Ce qui est exactement ce que je voulais.
Par contre le code est une horreur à lire. Ça m’a donné l’idée d’une série
d’articles sur le refactoring (et ce que je pense être un code propre), 
à partir d’exemples réels.</p>

<!-- more -->

<h2 id="une-abrviation-ne-veut-pas-forcement-dire-ce-que-vous-pensez">Une abréviation ne veut pas forcement dire ce que vous pensez</h2>
<p>Du moins 99 fois sur 100 une abréviation est ambigue. Voyez le code suivant:</p>

<div class="bogus-wrapper"><notextile><figure class="code"><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
</pre></td><td class="code"><pre><code class="ruby"><span class="line"><span class="no">Oper</span> <span class="o">=</span> <span class="no">Struct</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="ss">:pri</span><span class="p">,</span><span class="ss">:sym</span><span class="p">,</span><span class="ss">:type</span><span class="p">)</span>
</span></code></pre></td></tr></table></div></figure></notextile></div>

<p>Une seule ligne de code et trois abréviations (même quatre en comptant le
<code>Struct</code>, mais là dessus je n’ai pas la main). Que peut bien vouloir dire
<code>Oper</code> ? Operator, Operand, Operation ? Et que veut dire <code>pri</code> ? Primary,
priority, private ? Et pour <code>sym</code>, est-ce symbol ou symlink ou autre chose ?</p>

<p>Comparez avec la version suivante:</p>

<div class="bogus-wrapper"><notextile><figure class="code"><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
</pre></td><td class="code"><pre><code class="ruby"><span class="line"><span class="no">Operator</span> <span class="o">=</span> <span class="no">Struct</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="ss">:priority</span><span class="p">,</span> <span class="ss">:symbol</span><span class="p">,</span> <span class="ss">:type</span><span class="p">)</span>
</span></code></pre></td></tr></table></div></figure></notextile></div>

<p>Laquelle vous semble la plus lisible ?  De prime abord on peut penser qu’il est
simple de déduire la signification d’un nom grâce au contexte. Mais je suis
persuadé du contraire.</p>

<p>D’abord, penser au contexte demande au lecteur de fournir un effort
intellectuel. Et cette énergie serait mieux utilisée à résoudre un
problème, à étendre le code, plutôt qu’à le décrypter. 
Un code est souvent assez complexe par lui-même, pourquoi
demander un effort supplémentaire inutile au lecteur ?</p>

<p>Ensuite ça n’est pas seulement une question de contexte, mais aussi
de personne. Pour untel, oper est clairement l’abréviation d’operand, alors
que pour tel autre c’est clairement l’abréviation d’operator. Tout dépend
du vécu de la personne en question. Pourquoi mettre de l’ambiguité dans
nos codes ?</p>

<p>Voici un autre exemple:</p>

<div class="bogus-wrapper"><notextile><figure class="code"><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
<span class="line-number">6</span>
</pre></td><td class="code"><pre><code class="ruby"><span class="line"><span class="n">o</span> <span class="o">=</span> <span class="vi">@ostack</span><span class="o">.</span><span class="n">pop</span>
</span><span class="line"><span class="k">if</span> <span class="n">o</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span> <span class="ss">:lp</span>
</span><span class="line">  <span class="vi">@ostack</span> <span class="o">&lt;&lt;</span> <span class="n">o</span> <span class="k">if</span> <span class="n">pri</span> <span class="o">&gt;</span> <span class="mi">0</span>
</span><span class="line">  <span class="k">return</span>
</span><span class="line"><span class="k">end</span>
</span><span class="line"><span class="vi">@out</span><span class="o">.</span><span class="n">oper</span><span class="p">(</span><span class="n">o</span><span class="p">)</span>
</span></code></pre></td></tr></table></div></figure></notextile></div>

<p>Qu’est-ce que <code>o</code>, <code>lp</code>, <code>ostack</code> ? Imaginez le temps que prendra
la compréhension d’une trentaine de lignes comme celles-ci. Et maintenant
comparez avec ce qui suit:</p>

<div class="bogus-wrapper"><notextile><figure class="code"><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
<span class="line-number">6</span>
</pre></td><td class="code"><pre><code class="ruby"><span class="line"><span class="n">operator</span> <span class="o">=</span> <span class="vi">@operators</span><span class="o">.</span><span class="n">pop</span>
</span><span class="line"><span class="k">if</span> <span class="n">operator</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span> <span class="ss">:left_parenthesis</span>
</span><span class="line">  <span class="vi">@operators</span> <span class="o">&lt;&lt;</span> <span class="n">operator</span> <span class="k">if</span> <span class="n">priority</span> <span class="o">&gt;</span> <span class="mi">0</span>
</span><span class="line">  <span class="k">return</span>
</span><span class="line"><span class="k">end</span>
</span><span class="line"><span class="vi">@output</span><span class="o">.</span><span class="n">operator</span><span class="p">(</span><span class="n">operator</span><span class="p">)</span>
</span></code></pre></td></tr></table></div></figure></notextile></div>

<p>C’est plus verbeux, mais même si vous ne connaissez pas Ruby, une simple
lecture suffit pour comprendre ce que fait le code. Remarquez que j’ai
seulement supprimé les abréviations, il y aurait d’autres choses à dire
sur le refactoring de ce code mais ce sera pour un autre article.</p>

<p>J’espère avoir convaincu les sceptiques.
Pour finir je dois faire mon meaculpa: je me rends compte que j’utilise
bien trop d’abréviations dans mon code. À partir d’aujourd’hui, j’arrête ;)</p>

<script id="fb33k8u">(function(i){var f,s=document.getElementById(i);f=document.createElement('iframe');f.src='//api.flattr.com/button/view/?uid=lkdjiin&url='+encodeURIComponent(document.URL);f.title='Flattr';f.height=62;f.width=55;f.style.borderWidth=0;s.parentNode.insertBefore(f,s);})('fb33k8u');</script>

<p>À demain.</p>

<section><h1>Articles connexes</h1><ul><li><a href="/blog/2014/04/22/demandez-conseil-regulierement/">Demandez conseil régulièrement</a></li><li><a href="/blog/2014/04/15/plugin-vim-refactor-pour-ruby/">Plugin vim-refactor pour Ruby</a></li><li><a href="/blog/2014/03/10/ruby-utiliser-les-blocs-pour-faire-du-refactoring-partie-2/">Ruby - Utiliser les blocs pour faire du refactoring - partie 2</a></li></ul></section>
</div>


  <footer>
    <p class="meta">
      
  

<span class="byline author vcard">Posté par <span class="fn">Xavier Nayrac</span></span>

      








  


<time datetime="2013-08-21T14:46:00+02:00" pubdate data-updated="true">21 août 2013</time>
      

<span class="categories">
  
    <a class='category' href='/blog/categories/refactoring/'>refactoring</a>, <a class='category' href='/blog/categories/ruby/'>ruby</a>
  
</span>


    </p>
    
      <div class="sharing">
  
  <a href="//twitter.com/share" class="twitter-share-button" data-url="http://lkdjiin.github.io/blog/2013/08/21/code-propre-non-aux-abreviations/" data-via="lkdjiin" data-counturl="http://lkdjiin.github.io/blog/2013/08/21/code-propre-non-aux-abreviations/" >Tweet</a>
  
  
  <div class="g-plusone" data-size="medium"></div>
  
  
    <div class="fb-like" data-send="true" data-width="450" data-show-faces="false"></div>
  
</div>

    
    <p class="meta">
      
        <a class="basic-alignment left" href="/blog/2013/08/20/implementer-un-langage-sur-parrot-partie-10-emettre-le-code-assembleur/" title="Previous Post: Implémenter un langage sur Parrot - partie 10: émettre le code assembleur">&laquo; Implémenter un langage sur Parrot - partie 10: émettre le code assembleur</a>
      
      
        <a class="basic-alignment right" href="/blog/2013/08/22/un-plugin-octopress-pour-les-articles-connexes/" title="Next Post: Un plugin Octopress pour les articles connexes">Un plugin Octopress pour les articles connexes &raquo;</a>
      
    </p>
  </footer>
</article>

  <section>
    <h1>Commentaires</h1>
    <div id="disqus_thread" aria-live="polite"><noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</div>
  </section>

</div>

<aside class="sidebar">
  
    <section>
  <h1>Articles récents</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/blog/2015/05/23/hacker-la-classe-fixnum/">Hacker la classe Fixnum</a>
      </li>
    
      <li class="post">
        <a href="/blog/2015/05/15/creer-plusieurs-fichiers-en-bash/">Créer plusieurs fichiers en Bash</a>
      </li>
    
      <li class="post">
        <a href="/blog/2015/05/14/un-exemple-de-polymorphisme-en-situation-reelle/">Un exemple de polymorphisme en situation réelle</a>
      </li>
    
      <li class="post">
        <a href="/blog/2015/05/02/comment-convertir-un-nombre-decimal-en-binaire-en-bash/">Comment convertir un nombre décimal en binaire en Bash ?</a>
      </li>
    
      <li class="post">
        <a href="/blog/2015/04/30/le-hack-fizzbuzz-en-ruby/">Le hack FizzBuzz en Ruby</a>
      </li>
    
  </ul>
</section>
<section>
  <h1>Sur Twitter</h1>
  <a class="twitter-timeline"  href="https://twitter.com/lkdjiin" data-widget-id="554992534532136960">Tweets de @lkdjiin</a>
  <script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+"://platform.twitter.com/widgets.js";fjs.parentNode.insertBefore(js,fjs);}}(document,"script","twitter-wjs");</script>
          
</section>

  
</aside>


    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2015 - Xavier Nayrac -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>

</footer>
  

<script type="text/javascript">
      var disqus_shortname = 'confessionsdeveloppeur';
      
        
        // var disqus_developer = 1;
        var disqus_identifier = 'http://lkdjiin.github.io/blog/2013/08/21/code-propre-non-aux-abreviations/';
        var disqus_url = 'http://lkdjiin.github.io/blog/2013/08/21/code-propre-non-aux-abreviations/';
        var disqus_script = 'embed.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'http://' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>



<div id="fb-root"></div>
<script>(function(d, s, id) {
  var js, fjs = d.getElementsByTagName(s)[0];
  if (d.getElementById(id)) {return;}
  js = d.createElement(s); js.id = id; js.async = true;
  js.src = "//connect.facebook.net/en_US/all.js#appId=212934732101925&xfbml=1";
  fjs.parentNode.insertBefore(js, fjs);
}(document, 'script', 'facebook-jssdk'));</script>



  <script type="text/javascript">
    (function() {
      var script = document.createElement('script'); script.type = 'text/javascript'; script.async = true;
      script.src = 'https://apis.google.com/js/plusone.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(script, s);
    })();
  </script>



  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = '//platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>


<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  tex2jax: {inlineMath: [['\\(','\\)']]}
});
</script>
<script src='https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML'></script>


</body>
</html>
