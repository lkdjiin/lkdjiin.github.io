<!DOCTYPE html>
<html lang="fr"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" href="/assets/main.css"><link type="application/atom+xml" rel="alternate" href="http://lkdjiin.github.io/atom.xml" title="Xavier Nayrac" /></head>
<body><header class="site-header" role="banner">

  <div class="wrapper"><a class="site-title" rel="author" href="/">Xavier Nayrac</a><nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger"><a class="page-link" href="/about/">À propos</a></div>
      </nav></div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">Remplacer Sed et Awk par Ruby: Un dernier exemple</h1>
    <p class="post-meta">
      <time class="dt-published" datetime="2013-12-22T20:58:00+01:00" itemprop="datePublished">22 December 2013
      </time></p>
  </header>

  <div class="post-content e-content" itemprop="articleBody">
    <p>Avant de mettre un terme à cette série d’articles, j’aimerais donner
un dernier exemple concret de l’utilisation de Ruby en <em>mode</em> Sed/Awk.
Il y a quelques jours, j’ai ajouté un bouton «flattr» à la fin des
quelques 160 articles de ce blog. Voici comment j’ai fait…</p>

<!-- more -->

<p>Tout d’abord le script Ruby:</p>

<figure class="highlight"><pre><code class="language-ruby" data-lang="ruby"><span class="k">BEGIN</span><span class="p">{</span><span class="n">code</span><span class="o">=</span> <span class="s2">"code à insérer"</span><span class="p">}</span>

<span class="k">if</span> <span class="vg">$_</span><span class="p">.</span><span class="nf">start_with?</span><span class="p">(</span><span class="s2">"À demain."</span><span class="p">)</span>
  <span class="vg">$_</span> <span class="o">=</span> <span class="s2">"</span><span class="se">\n\n</span><span class="si">#{</span><span class="n">code</span><span class="si">}</span><span class="se">\n\n</span><span class="si">#{</span><span class="vg">$_</span><span class="si">}</span><span class="s2">"</span>
<span class="k">end</span></code></pre></figure>

<p>Je cherche à insérer le code avant la chaîne “À demain.”, qui termine
chacun de mes articles. Si vous avez suivi cette série d’articles depuis
le début, j’espère que ce script parle de lui-même…
Notez quand même que ce script demande une version de Ruby supérieure
ou égale à 2.0, ou alors il faudra ajouter un commentaire <em>magique</em> pour
spécifier l’encodage utf-8.</p>

<p>Maintenant, comment appliquer ce script à chacun des articles. J’ai choisi
d’utiliser une boucle en Bash:</p>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash"><span class="o">[</span>~]⇒ <span class="k">for </span>i <span class="k">in</span> <span class="k">*</span>.markdown<span class="p">;</span> <span class="k">do </span>ruby <span class="nt">-p</span> <span class="nt">-i</span> script.rb <span class="nv">$i</span><span class="p">;</span> <span class="k">done</span></code></pre></figure>

<p>Si vous avez besoin d’explications sur cette ligne de commande, je vous
renvoie à ces articles:</p>

<ul>
  <li><a href="http://lkdjiin.github.io/blog/2013/12/04/remplacer-sed-et-awk-par-ruby-4-les-options-p-et-l/">ruby -p</a></li>
  <li><a href="http://lkdjiin.github.io/blog/2013/12/08/remplacer-sed-et-awk-par-ruby-7-modifier-slash-sauvegarder-les-donnees/">ruby -i</a></li>
  <li><a href="http://lkdjiin.github.io/blog/2013/08/23/bash-ajouter-une-ligne-a-la-fin-de-plusieurs-fichiers/">Les boucles en Bash</a></li>
</ul>

<p>À demain.</p>


  </div>

  <br/>
  <br/>
  <div style="text-align: center">/ / / / / / / / / /</div>
  <br/>
  <br/>

  <div style="text-align: center">
    
      <a href="/blog/2013/12/21/remplacer-sed-et-awk-par-ruby-flip-flop/" title="Article précédent: Remplacer Sed et Awk par Ruby: Flip flop">&laquo; Remplacer Sed et Awk par Ruby: Flip flop</a> ---//---
    
    
      <a href="/blog/2013/12/23/les-algorithmes-genetiques-demystifies-47-economie/" title="Article suivant: Les algorithmes génétiques démystifiés 47: Économie">Les algorithmes génétiques démystifiés 47: Économie &raquo;</a>
    
  </div>

  <br/>
  <br/><div id="disqus_thread"></div>
  <script>
    var disqus_config = function () {
      this.page.url = 'http://lkdjiin.github.io/blog/2013/12/22/remplacer-sed-et-awk-par-ruby-un-dernier-exemple/';
      this.page.identifier = 'http://lkdjiin.github.io/blog/2013/12/22/remplacer-sed-et-awk-par-ruby-un-dernier-exemple/';
    };

    (function() {
      var d = document, s = d.createElement('script');

      s.src = 'https://confessionsdeveloppeur.disqus.com/embed.js';

      s.setAttribute('data-timestamp', +new Date());
      (d.head || d.body).appendChild(s);
    })();
  </script>
  <noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a></noscript><a class="u-url" href="/blog/2013/12/22/remplacer-sed-et-awk-par-ruby-un-dernier-exemple/" hidden></a>
</article>

      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/"></data>

  <div class="wrapper">

    <div>
    <p class="rss-subscribe">s'abonner <a href="/atom.xml">via RSS</a></p>
    </div>

    <h2 class="footer-heading">Xavier Nayrac</h2>

    <div class="footer-col-wrapper">
      <div class="footer-col footer-col-1">
        <ul class="contact-list">
          <li class="p-name">
            Copyright 2013 - 2021
            </li><li><a class="u-email" href="mailto:"></a></li></ul>
      </div>

      <div class="footer-col footer-col-2"><ul class="social-media-list">

  <li>
    <a href="https://github.com/lkdjiin">
      <img src="/images/github.png" />
      <span class="username">lkdjiin</span>
    </a>
  </li>

  <li>
    <a href="https://www.twitter.com/lkdjiin">
      <img src="/images/twitter.png" />
      <span class="username">lkdjiin</span>
    </a>
  </li>

  <li>
    <a href="/atom.xml">
      <img src="/images/atom.png" />
      <span class="username">RSS</span>
    </a>
  </li>
</ul>
</div>

      <div class="footer-col footer-col-3">
        <p>Dev accro au TDD, Rubyiste mais pas que, musicien, maker, créateur d&#39;effets pour guitare, heureux utilisateur de Vim.</p>
      </div>
    </div>

  </div>

</footer>
</body>

</html>
